<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Karoot | ŸÉÿ±Ÿàÿ™</title>
    
    <!-- Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* --- VARIABLES --- */
        :root {
            --bg-size: 400% 400%;
            --anim-speed: 15s;
        }

        /* === DARK MODE (Default) === */
        [data-mode="dark"] {
            --text-main: #ffffff;
            --text-sub: rgba(255,255,255,0.7);
            --card-bg: #2d3436;
            --modal-bg: #1e1e24;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
            --btn-active-bg: #ffffff;
            --btn-active-text: #000000;
        }

        /* === LIGHT MODE === */
        [data-mode="light"] {
            --text-main: #2d3436;
            --text-sub: rgba(0,0,0,0.6);
            --card-bg: #ffffff;
            --modal-bg: #f5f6fa;
            --glass-bg: rgba(255, 255, 255, 0.65);
            --glass-border: rgba(255, 255, 255, 0.9);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
            --btn-active-bg: #2d3436;
            --btn-active-text: #ffffff;
        }

        /* === THEMES (Gradients) === */
        [data-theme="galaxy"] { 
            --bg-image: linear-gradient(-45deg, #240b36, #c31432, #240b36, #0f0c29);
            --accent: #ff007f; --accent-glow: rgba(255, 0, 127, 0.6); 
        }
        [data-theme="ocean"] { 
            --bg-image: linear-gradient(-45deg, #000428, #004e92, #000428);
            --accent: #00d2d3; --accent-glow: rgba(0, 210, 211, 0.6); 
        }
        [data-theme="forest"] { 
            --bg-image: linear-gradient(-45deg, #000000, #0f9b0f, #000000);
            --accent: #00b894; --accent-glow: rgba(0, 184, 148, 0.6); 
        }
        [data-theme="gold"] { 
            --bg-image: linear-gradient(-45deg, #1e1e1e, #b8860b, #1e1e1e);
            --accent: #ffd700; --accent-glow: rgba(255, 215, 0, 0.6); 
        }

        /* Light Mode Overrides */
        [data-mode="light"][data-theme="galaxy"] { --bg-image: linear-gradient(-45deg, #ff9a9e, #fad0c4); --accent: #ff6b6b; }
        [data-mode="light"][data-theme="ocean"] { --bg-image: linear-gradient(-45deg, #a18cd1, #fbc2eb); --accent: #6c5ce7; }

        /* --- GLOBAL --- */
        body {
            background: var(--bg-image);
            background-size: var(--bg-size);
            animation: gradientBG var(--anim-speed) ease infinite;
            color: var(--text-main);
            min-height: 100vh;
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
            user-select: none;
            transition: color 0.3s ease;
        }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        body[dir="rtl"] { font-family: 'Cairo', sans-serif; }

        /* --- BACKGROUND DECORATION --- */
        #bg-decor-layer { position: fixed; inset: 0; pointer-events: none; z-index: 0; overflow: hidden; }
        .decor-card {
            position: absolute; width: 120px; height: 180px; 
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px; backdrop-filter: blur(3px); z-index: 0;
        }
        .d1 { top: 10%; left: -20px; transform: rotate(-15deg); animation: float 8s ease-in-out infinite; }
        .d2 { bottom: 15%; right: -20px; transform: rotate(10deg); animation: float 9s ease-in-out infinite reverse; }
        .d3 { top: 40%; right: 10%; transform: rotate(25deg) scale(0.6); animation: float 10s ease-in-out infinite 1s; opacity: 0.5; }
        @keyframes float { 0%,100% { transform: translateY(0) rotate(var(--r, 0deg)); } 50% { transform: translateY(-20px) rotate(var(--r, 0deg)); } }

        /* --- UI COMPONENTS --- */
        .ui-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 20px;
            transition: 0.3s;
        }
        .ui-panel:active { transform: scale(0.98); }

        .btn-icon { 
            background: transparent; border: none; font-size: 1.4rem; 
            color: var(--text-main); padding: 12px; transition: 0.2s; 
            cursor: pointer; z-index: 50; position: relative;
        }
        .btn-icon:hover { transform: scale(1.1); color: var(--accent); }

        .screen { display: none; height: 100vh; flex-direction: column; position: relative; z-index: 10; overflow-y: auto; overflow-x: hidden; }
        .screen.active { display: flex; animation: fadeIn 0.5s; }

        /* --- LANDING --- */
        #screen-landing { justify-content: center; align-items: center; text-align: center; }
        .hero-logo { font-size: 4rem; font-weight: 900; letter-spacing: -3px; z-index: 2; text-shadow: 0 10px 40px rgba(0,0,0,0.4); }
        .btn-start {
            padding: 16px 60px; font-size: 1.3rem; font-weight: 800; border-radius: 50px;
            border: none; background: var(--text-main); color: var(--card-bg);
            box-shadow: 0 0 20px var(--accent-glow); transition: 0.3s; cursor: pointer;
        }
        .btn-start:hover { transform: scale(1.05); box-shadow: 0 0 40px var(--accent-glow); }

        /* --- SETUP --- */
        .role-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .role-full { grid-column: span 2; }
        
        .role-btn { height: 100px; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; color: var(--text-main); }
        .role-btn.selected { background: var(--accent); color: white !important; border-color: white; }
        .count-btn { width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 1px solid var(--text-sub); color: var(--text-main); cursor: pointer; transition: 0.2s; }
        .count-btn.active { background: var(--accent); color: white; border-color: white; font-weight: bold; transform: scale(1.15); box-shadow: 0 0 15px var(--accent-glow); }

        /* --- GAMEPLAY --- */
        #screen-game { justify-content: space-between; }
        .card-stage { flex-grow: 1; width: 100%; display: flex; justify-content: center; align-items: center; perspective: 1000px; padding: 20px; position: relative; }
        .game-card {
            width: 90%; max-width: 350px; height: 520px;
            background: var(--card-bg); color: var(--text-main);
            border-radius: 26px; padding: 40px 30px; 
            text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border: 8px solid var(--card-bg); position: relative;
        }
        .game-card::after { content: ''; position: absolute; inset: 15px; border: 2px dashed var(--accent); border-radius: 18px; opacity: 0.6; pointer-events: none; }
        .card-title { font-size: 1.6rem; font-weight: 800; line-height: 1.5; }
        .btn-control-prev { width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: var(--glass-bg); color: var(--text-main); border: 1px solid var(--glass-border); cursor: pointer; }
        .btn-control-next { background: var(--accent); color: white; border: none; padding: 15px 50px; border-radius: 50px; font-weight: bold; font-size: 1.2rem; box-shadow: 0 5px 20px rgba(0,0,0,0.3); transition: 0.2s; }
        .btn-control-next:active { transform: scale(0.95); }

        /* --- MODAL --- */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; backdrop-filter: blur(10px); display: none; justify-content: center; align-items: flex-end; }
        .modal-panel { background: var(--modal-bg); width: 100%; border-radius: 30px 30px 0 0; padding: 30px; color: var(--text-main); max-height: 90vh; overflow-y: auto; animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); box-shadow: 0 -10px 40px rgba(0,0,0,0.3); }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        /* --- CUSTOM DIALOGS --- */
        .dialog-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 9999;
            backdrop-filter: blur(12px); display: none; 
            justify-content: center; align-items: center;
            padding: 20px;
        }
        .dialog-box {
            background: var(--modal-bg); width: 100%; max-width: 350px;
            border-radius: 25px; padding: 30px; text-align: center;
            border: 1px solid var(--glass-border);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .dialog-title { font-weight: 900; font-size: 1.5rem; margin-bottom: 10px; color: var(--accent); }
        .dialog-msg { margin-bottom: 25px; color: var(--text-main); opacity: 0.9; }
        .dialog-actions { display: flex; gap: 10px; justify-content: center; }
        .btn-dialog { flex: 1; padding: 12px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-dialog-primary { background: var(--accent); color: white; }
        .btn-dialog-secondary { background: var(--glass-bg); color: var(--text-main); border: 1px solid var(--text-sub); }
        .btn-dialog:active { transform: scale(0.95); }

        /* --- UI HELPERS --- */
        .theme-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .theme-btn {
            height: 60px; border-radius: 15px; cursor: pointer;
            border: 2px solid transparent; transition: 0.2s;
            position: relative; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }
        .theme-btn.active { border: 2px solid var(--text-main); transform: scale(0.98); }
        .theme-btn.active::after { content: '‚úî'; color: white; font-weight: bold; font-size: 1.2rem; text-shadow: 0 2px 5px rgba(0,0,0,0.5); }
        .lang-btn { border: none; background: transparent; color: var(--text-main); font-weight: 500; transition: 0.3s; opacity: 0.7; }
        .lang-btn:hover { opacity: 1; }
        .lang-btn.active { background: var(--btn-active-bg); color: var(--btn-active-text); font-weight: 800; opacity: 1; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .toggle-switch { width: 50px; height: 26px; background: var(--text-sub); border-radius: 20px; position: relative; cursor: pointer; }
        .toggle-switch.active { background: var(--accent); }
        .toggle-knob { width: 22px; height: 22px; background: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: 0.3s; }
        .toggle-switch.active .toggle-knob { left: 26px; }
        .btn-settings-bright { color: white !important; opacity: 0.8; text-decoration: underline; font-weight: 600; transition: 0.3s; }
        .btn-settings-bright:hover { opacity: 1; letter-spacing: 0.5px; }

    </style>
</head>
<body data-mode="dark" data-theme="galaxy">

    <!-- BACKGROUND DECORATION -->
    <div id="bg-decor-layer">
        <div class="decor-card d1"></div>
        <div class="decor-card d2"></div>
        <div class="decor-card d3"></div>
        <div id="particles"></div>
    </div>

    <!-- 0. LANDING -->
    <div id="screen-landing" class="screen active">
        <div class="animate__animated animate__zoomIn">
            <h1 class="hero-logo mb-1" style="color: var(--accent);">KAROOT</h1>
            <p class="text-sub mb-5 fw-bold" style="letter-spacing: 1px;">Icebreakers & Deep Talk</p>
            <button class="btn-start animate__animated animate__pulse animate__infinite" onclick="enterApp()">
                <span id="txt-start">Tap to Start</span>
            </button>
        </div>
        <div class="fixed-bottom pb-4 animate__animated animate__fadeInUp animate__delay-1s">
            <small class="text-sub text-uppercase letter-spacing-2" style="font-size: 0.7rem;">Developed By</small><br>
            <a href="https://mfouadbakr.github.io/portfolio/index.html" target="_blank" style="color: var(--accent); text-decoration: none; font-weight: 800;">
                Mohamed Bakr
            </a>
        </div>
    </div>

    <!-- 1. SETUP -->
    <div id="screen-setup" class="screen pt-5 justify-content-center">
        <div class="container">
            <h2 class="text-center fw-bold mb-1" id="lbl-setup-title">Setup Game</h2>
            <p class="text-center text-sub mb-4" id="lbl-setup-desc">Customize your session</p>

            <div class="ui-panel p-4 mb-4">
                <label class="d-block text-sub small mb-3 text-uppercase" id="lbl-count">Number of Questions</label>
                <div class="d-flex justify-content-between px-2">
                    <div class="count-btn" onclick="setCount(10)">10</div>
                    <div class="count-btn" onclick="setCount(20)">20</div>
                    <div class="count-btn active" id="btn-c-30" onclick="setCount(30)">30</div>
                    <div class="count-btn" onclick="setCount(40)">40</div>
                    <div class="count-btn" onclick="setCount(50)">50</div>
                </div>
            </div>

            <label class="d-block text-sub small mb-3 text-uppercase px-3" id="lbl-role">Group Type</label>
            <div class="role-grid px-2">
                <div class="ui-panel role-btn" onclick="setRole('friends')"><div class="display-5 mb-2">ü§ò</div><span id="role-friends">Friends</span></div>
                <div class="ui-panel role-btn" onclick="setRole('couples')"><div class="display-5 mb-2">‚ù§Ô∏è</div><span id="role-couples">Couples</span></div>
                <div class="ui-panel role-btn" onclick="setRole('family')"><div class="display-5 mb-2">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div><span id="role-family">Family</span></div>
                <div class="ui-panel role-btn" onclick="setRole('work')"><div class="display-5 mb-2">üíº</div><span id="role-work">Coworkers</span></div>
                <div class="ui-panel role-btn role-full" onclick="setRole('all')"><div class="display-5 mb-2">üé≤</div><span id="role-all">Mix</span></div>
            </div>
        </div>
        
        <div class="text-center mt-5 mb-3">
            <button onclick="toggleSettings()" class="btn btn-sm btn-settings-bright" id="btn-settings-link">Settings & Language</button>
        </div>
    </div>

    <!-- 2. TOPICS -->
    <div id="screen-cats" class="screen pt-5">
        <div class="container">
            <div class="d-flex align-items-center justify-content-between mb-4 px-2">
                <button onclick="showScreen('screen-setup')" class="ui-panel btn-icon">‚Üê</button>
                <h2 class="fw-bold m-0" id="lbl-choose-cat">Choose Topic</h2>
                <div style="width:40px"></div>
            </div>
            <div class="row g-3" id="categories-container"></div>
        </div>
    </div>

    <!-- 3. GAME -->
    <div id="screen-game" class="screen pt-3">
        <!-- Top Bar with Z-Index fix for exit button -->
        <div class="d-flex justify-content-between align-items-center px-4 mb-2" style="position: relative; z-index: 100;">
            <button onclick="confirmExit()" class="ui-panel btn-icon" style="background: rgba(200,0,0,0.1); border-color: rgba(200,0,0,0.3);">‚úï</button>
            <span class="text-sub text-uppercase small" id="game-cat-title">TOPIC</span>
            <button onclick="toggleSettings()" class="ui-panel btn-icon">‚öôÔ∏è</button>
        </div>

        <div class="px-4">
            <div class="progress" style="height: 6px; background: rgba(255,255,255,0.2);">
                <div class="progress-bar" id="game-progress" style="width: 0%; background: var(--accent);"></div>
            </div>
            <div class="text-end text-sub small mt-1" id="counter">1 / 30</div>
        </div>

        <div class="card-stage" id="card-stage"></div>

        <div class="d-flex justify-content-center align-items-center gap-4 pb-5">
            <button class="btn-control-prev" onclick="prevCard()" id="btn-prev">‚Ü©</button>
            <button class="btn-control-next animate__animated animate__pulse animate__infinite" onclick="nextCard()" id="btn-next">
                Next Card
            </button>
        </div>
    </div>

    <!-- CUSTOM DIALOG -->
    <div id="custom-dialog" class="dialog-overlay">
        <div class="dialog-box animate__animated animate__zoomIn">
            <div class="dialog-title" id="d-title">Title</div>
            <div class="dialog-msg" id="d-msg">Message goes here</div>
            <div class="dialog-actions">
                <button class="btn-dialog btn-dialog-secondary" id="d-btn-cancel" onclick="closeDialog()">Cancel</button>
                <button class="btn-dialog btn-dialog-primary" id="d-btn-ok">OK</button>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="modal-settings" class="modal-overlay" onclick="if(event.target === this) toggleSettings()">
        <div class="modal-panel">
            <div class="d-flex justify-content-between mb-4">
                <h4 class="fw-bold m-0" id="lbl-settings-modal">Settings</h4>
                <button onclick="toggleSettings()" class="ui-panel btn-icon rounded-circle" style="padding: 5px 12px;">‚úï</button>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-4">
                <span class="fw-bold" id="lbl-mode">Dark Mode</span>
                <div class="toggle-switch active" id="toggle-mode" onclick="toggleMode()"><div class="toggle-knob"></div></div>
            </div>

            <label class="text-sub small text-uppercase mb-3" id="lbl-theme">Theme</label>
            <div class="theme-grid mb-4">
                <div class="theme-btn active" style="background: linear-gradient(135deg, #240b36, #c31432)" onclick="setTheme('galaxy', this)"></div>
                <div class="theme-btn" style="background: linear-gradient(135deg, #000428, #004e92)" onclick="setTheme('ocean', this)"></div>
                <div class="theme-btn" style="background: linear-gradient(135deg, #000000, #0f9b0f)" onclick="setTheme('forest', this)"></div>
                <div class="theme-btn" style="background: linear-gradient(135deg, #1e1e1e, #b8860b)" onclick="setTheme('gold', this)"></div>
            </div>

            <hr class="border-secondary my-3">

            <label class="text-sub small text-uppercase mb-3" id="lbl-ui-lang">Language</label>
            <div class="ui-panel p-1 d-flex rounded-pill mb-4">
                <button class="lang-btn active w-50 rounded-pill" id="btn-lang-en" onclick="setUILang('en')">English</button>
                <button class="lang-btn w-50 rounded-pill" id="btn-lang-ar" onclick="setUILang('ar')">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
            </div>
        </div>
    </div>

    <!-- LOGIC -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        const uiDict = {
            en: {
                start_btn: "Tap to Start", setup_title: "Setup Game", setup_desc: "Customize your session",
                lbl_count: "Number of Questions", lbl_role: "Group Type",
                roles: { friends: "Friends", couples: "Couples", family: "Family", work: "Co-workers", all: "Mix" },
                btn_settings: "Settings & Language", choose_cat: "Choose Topic",
                next: "Next Card", finish: "Finish Game", settings_modal: "Settings",
                ui_lang: "Language", theme: "Galaxy Theme", mode: "Dark Mode",
                cats: { 
                    ice: "Icebreakers", fun: "Funny", deep: "Deep Talk", love: "Romance", 
                    confess: "Confessions", tell: "Stories", 
                    career: "Career & Work", travel: "Travel", whatif: "What If?",
                    debate: "Debates", truth: "Truth", context: "Association", wishes: "Wishes", advice: "Advice",
                    rand: "Random Mix" 
                },
                exit_confirm: "Exit current game?",
                game_over: "All Questions Done!",
                game_over_msg: "Do you want to play another round?",
                yes: "Yes", no: "No", ok: "OK", cancel: "Cancel"
            },
            ar: {
                start_btn: "ÿßÿ∂ÿ∫ÿ∑ ŸÑŸÑÿ®ÿØÿ°", setup_title: "ÿ•ÿπÿØÿßÿØ ÿßŸÑŸÑÿπÿ®ÿ©", setup_desc: "ÿ∏ÿ®ÿ∑ ÿßŸÑŸÇÿπÿØÿ©",
                lbl_count: "ÿπÿØÿØ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ©", lbl_role: "ŸÖŸäŸÜ ŸáŸäŸÑÿπÿ®ÿü",
                roles: { friends: "ÿßŸÑÿµÿ≠ŸÄÿßÿ®", couples: "ŸÉÿßÿ®ŸÑÿ≤", family: "ÿßŸÑÿπŸäŸÑŸÄÿ©", work: "ÿ≤ŸÖŸÑÿßÿ° ÿπŸÖŸÑ", all: "ŸÉŸàŸÉÿ™ŸäŸÑ" },
                btn_settings: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸàÿßŸÑŸÑÿ∫ÿ©", choose_cat: "ÿßÿÆÿ™ÿßÿ± ÿßŸÑŸÖŸàÿ∂Ÿàÿπ",
                next: "ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ™ÿßŸÑŸä", finish: "ÿ•ŸÜŸáÿßÿ° ÿßŸÑŸÑÿπÿ®ÿ©", settings_modal: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
                ui_lang: "ÿßŸÑŸÑÿ∫ÿ©", theme: "ÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖÿ¨ÿ±ÿ©", mode: "ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÑŸäŸÑŸä",
                cats: { 
                    ice: "ÿ™ÿ≥ÿÆŸäŸÜ", fun: "ÿ∂ÿ≠ŸÉ ŸàŸáÿ≤ÿßÿ±", deep: "ŸÉŸÑÿßŸÖ ÿπŸÖŸäŸÇ", love: "ÿ±ŸàŸÖÿßŸÜÿ≥Ÿäÿ©", 
                    confess: "ŸÉÿ±ÿ≥Ÿä ÿßŸÑÿßÿπÿ™ÿ±ÿßŸÅ", tell: "ÿßÿ≠ŸÉŸä Ÿäÿß ÿ¥Ÿáÿ±ÿ≤ÿßÿØ", 
                    career: "ÿ¥ÿ∫ŸÑ ŸàŸÉÿßÿ±Ÿäÿ±", travel: "ÿ≥ŸÅÿ± ŸàŸÖÿ∫ÿßŸÖÿ±ÿ©", whatif: "ŸÖÿßÿ∞ÿß ŸÑŸàÿü",
                    debate: "ŸÜŸÇÿßÿ¥ Ÿàÿ¨ÿØÿßŸÑ", truth: "ÿµÿ±ÿßÿ≠ÿ© Ÿàÿ®ÿ≥", context: "ÿ£ŸàŸÑ ÿÆÿßÿ∑ÿ±", wishes: "ÿ£ŸÖÿßŸÜŸä", advice: "ŸÜÿµŸäÿ≠ÿ© ÿØŸäŸÜŸäÿ©",
                    rand: "ŸÉŸàŸÉÿ™ŸäŸÑ ÿπÿ¥Ÿàÿßÿ¶Ÿä" 
                },
                exit_confirm: "ÿπÿßŸäÿ≤ ÿ™ÿÆÿ±ÿ¨ ŸÖŸÜ ÿßŸÑÿ¨ŸäŸÖ ÿØŸáÿü",
                game_over: "ÿÆŸÑÿµÿ™ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ©!",
                game_over_msg: "ÿ™ÿ≠ÿ® ÿ™ŸÑÿπÿ® ÿ¨ŸàŸÑÿ© ŸÉŸÖÿßŸÜÿü",
                yes: "ÿ£ŸäŸàÿ©", no: "ŸÑÿ£", ok: "ÿ™ŸÖÿßŸÖ", cancel: "ÿ•ŸÑÿ∫ÿßÿ°"
            }
        };

        const baseCats = [
            // Original
            { id: 'ice', roles: ['friends','family','all','couples','work'], icon: 'üëã', q: ["ŸÑŸà ÿµÿ≠Ÿäÿ™ ŸÑŸÇŸäÿ™ ŸÜŸÅÿ≥ŸÉ ÿ®ŸÇŸäÿ™ ŸÖŸÑŸäŸàŸÜŸäÿ±ÿå ÿ£ŸàŸÑ ÿ≠ÿßÿ¨ÿ© Ÿáÿ™ÿπŸÖŸÑŸáÿß ÿßŸäŸáÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ÿ£ŸÉŸÑÿ© ŸÖÿµÿ±Ÿäÿ© ÿ®ÿ™ÿπÿ±ŸÅ ÿ™ÿ∑ÿ®ÿÆŸáÿßÿü","ŸÖŸäŸÜ ÿ£ŸÉÿ™ÿ± ŸÖÿØÿ±ÿ≥ ŸÖÿ£ÿ´ÿ± ŸÅŸäŸÉ ŸÖŸÜ ŸàÿßŸÜÿ™ ÿµÿ∫Ÿäÿ±ÿü","ÿßŸäŸá ÿßŸÑŸÖŸÉÿßŸÜ ÿßŸÑŸÑŸä ŸÅŸä ŸÖÿµÿ± ŸÜŸÅÿ≥ŸÉ ÿ™ÿ±Ÿàÿ≠Ÿáÿü","ŸÑŸà ÿ™ŸÇÿØÿ± ÿ™ÿ∫Ÿäÿ± ÿßÿ≥ŸÖŸÉÿå Ÿáÿ™ÿÆÿ™ÿßÿ± ÿßÿ≥ŸÖ ÿßŸäŸáÿü","ÿ®ÿ™ÿ≠ÿ® ÿßŸÑÿµŸäŸÅ ŸàÿßŸÑÿ®ÿ≠ÿ± ŸàŸÑÿß ÿßŸÑÿ¥ÿ™ÿßÿ° ŸàÿßŸÑŸÖÿ∑ÿ±ÿü","ÿßŸäŸá ÿßŸÑŸàÿ∏ŸäŸÅÿ© ÿßŸÑŸÑŸä ŸÉÿßŸÜ ŸÜŸÅÿ≥ŸÉ ÿ™ÿ¥ÿ™ÿ∫ŸÑŸáÿß ŸàÿßŸÜÿ™ ÿ∑ŸÅŸÑÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ŸÉÿ±ÿ™ŸàŸÜ ŸÉŸÜÿ™ ŸÖÿØŸÖŸÜ ÿπŸÑŸäŸá ÿ≤ŸÖÿßŸÜÿü"] },
            { id: 'fun', roles: ['friends','family','all','couples','work'], icon: 'üòÇ', q: ["ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ŸÖŸàŸÇŸÅ ŸÖÿ≠ÿ±ÿ¨ ÿ≠ÿµŸÑŸÉ ŸÅŸä ŸÖŸàÿßÿµŸÑÿßÿ™ÿü","ŸÑŸà ÿ®ŸÇŸäÿ™ ÿØÿ®ÿßŸÜÿ© ŸÑŸÖÿØÿ© ÿ≥ÿßÿπÿ©ÿå Ÿáÿ™ÿ∂ÿßŸäŸÇ ŸÖŸäŸÜÿü","ÿßŸäŸá ÿ£ÿ∫ÿ±ÿ® ÿ≠ÿßÿ¨ÿ© ÿßÿ¥ÿ™ÿ±Ÿäÿ™Ÿáÿß ÿßŸàŸÜŸÑÿßŸäŸÜ Ÿàÿ∑ŸÑÿπÿ™ ŸÖŸÇŸÑÿ®ÿü","ÿßÿ≠ŸÉŸäŸÑŸÜÿß ÿπŸÜ ÿ∑ÿ®ÿÆÿ© ÿ¨ÿ±ÿ®ÿ™ ÿ™ÿπŸÖŸÑŸáÿß Ÿàÿ≠ÿ±ŸÇÿ™ ÿßŸÑŸÖÿ∑ÿ®ÿÆÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ŸÑÿ®ÿ≥ ŸÜÿØŸÖÿ™ ÿßŸÜŸÉ ŸÑÿ®ÿ≥ÿ™Ÿáÿü","ŸÑŸà ÿ≠Ÿäÿßÿ™ŸÉ ŸÖŸäŸÖ (Meme)ÿå Ÿáÿ™ÿ®ŸÇŸâ ÿßŸÜŸáŸä Ÿàÿßÿ≠ÿØÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ŸÉÿØÿ®ÿ© ŸÉÿØÿ®ÿ™Ÿáÿß ÿπŸÑŸâ ÿ£ŸáŸÑŸÉ ÿπÿ¥ÿßŸÜ ÿ™ÿÆÿ±ÿ¨ÿü","ŸÑŸà ÿßÿ™ŸÇŸÅÿ¥ÿ™ ÿ®ÿ™ŸÉŸÑŸÖ ŸÜŸÅÿ≥ŸÉÿå ÿ®ÿ™ÿ®ÿ±ÿ± ÿßŸÑŸÖŸàŸÇŸÅ ÿßÿ≤ÿßŸäÿü"] },
            { id: 'deep', roles: ['friends','couples','all'], icon: 'üß†', q: ["ÿßŸäŸá ÿßŸÑÿØÿ±ÿ≥ ÿßŸÑŸÑŸä ÿßÿ™ÿπŸÑŸÖÿ™Ÿá ŸÅŸä ÿ≠Ÿäÿßÿ™ŸÉ ÿ®ÿßŸÑÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿµÿπÿ®ÿ©ÿü","ÿßŸÖÿ™Ÿâ ÿ¢ÿÆÿ± ŸÖÿ±ÿ© ÿπŸäÿ∑ÿ™ ŸÅŸäŸáÿßÿå ŸàÿßŸÑÿ≥ÿ®ÿ® ŸÉÿßŸÜ Ÿäÿ≥ÿ™ÿßŸáŸÑÿü","ÿ¥ÿßŸäŸÅ ŸÜŸÅÿ≥ŸÉ ÿ≠ŸÇŸÇÿ™ ÿ£ÿ≠ŸÑÿßŸÖ ÿ∑ŸÅŸàŸÑÿ™ŸÉÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ÿ≠ÿßÿ¨ÿ© ÿ®ÿ™ÿÆÿßŸÅ ŸÖŸÜŸáÿß (ÿßŸÑŸàÿ≠ÿØÿ©ÿå ÿßŸÑŸÖŸàÿ™ÿå ÿßŸÑŸÅÿ¥ŸÑ)ÿü","ŸÑŸà ÿ™ŸÇÿØÿ± ÿ™ÿ±ÿ¨ÿπ ÿ®ÿßŸÑÿ≤ŸÖŸÜ 5 ÿ≥ŸÜŸäŸÜÿå Ÿáÿ™ÿ∫Ÿäÿ± ÿßŸäŸáÿü","ŸÖŸäŸÜ ÿßŸÑÿ¥ÿÆÿµ ÿßŸÑŸÑŸä Ÿàÿ¨ŸàÿØŸá ÿ∫Ÿäÿ± ÿ≠Ÿäÿßÿ™ŸÉ ŸÑŸÑÿ£ÿ≠ÿ≥ŸÜÿü","ŸáŸÑ ÿßŸÜÿ™ ÿ±ÿßÿ∂Ÿä ÿπŸÜ ŸÜŸÅÿ≥ŸÉ ÿØŸÑŸàŸÇÿ™Ÿäÿü","ÿßŸäŸá ÿßŸÑÿ∞ŸÉÿ±Ÿâ ÿßŸÑŸÑŸä ÿ®ÿ™ÿ™ŸÖŸÜŸâ ÿ™ÿ™ŸÖÿ≥ÿ≠ ŸÖŸÜ ÿ∞ÿßŸÉÿ±ÿ™ŸÉÿü"] },
            { id: 'love', roles: ['couples'], icon: '‚ù§Ô∏è', q: ["ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ÿµŸÅÿ© ŸÅŸä ÿ¥ÿÆÿµŸäÿ™Ÿä ÿ®ÿ™ÿÆŸÑŸäŸÉ ÿ™ÿ™ÿ∑ŸÖŸÜÿü","ÿ¥ÿßŸäŸÅ ÿ≠Ÿäÿßÿ™ŸÜÿß ÿ¥ŸÉŸÑŸáÿß ÿßŸäŸá ŸÉŸÖÿßŸÜ 5 ÿ≥ŸÜŸäŸÜÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ÿ£ŸÉŸÑÿ© ÿ®ÿ≠ÿ®Ÿáÿß ŸÖŸÜ ÿßŸäÿØŸÉÿü","ŸÑŸà ŸáŸÜÿ±Ÿàÿ≠ ŸÖŸÉÿßŸÜ Ÿàÿßÿ≠ÿØ ÿ®ÿ≥ ŸÅŸä ÿßŸÑÿπÿßŸÑŸÖ ÿ≥Ÿàÿßÿå ÿ™ÿÆÿ™ÿßÿ±Ÿá ŸÅŸäŸÜÿü","ÿßŸäŸá ÿßŸÑÿ≠ÿßÿ¨ÿ© ÿßŸÑŸÑŸä ÿ®ÿπŸÖŸÑŸáÿß Ÿàÿ®ÿ™ŸÅÿ±ÿ≠ŸÉ ÿßŸàŸäÿü","ŸÑŸà ŸÉÿ≥ÿ®ŸÜÿß ŸÅŸÑŸàÿ≥ ŸÉÿ™Ÿäÿ±ÿå ŸáŸÜÿ¨Ÿäÿ® ÿßŸäŸá ŸÑÿ®Ÿäÿ™ŸÜÿßÿü","ÿßŸäŸá ÿßŸÑŸÅŸäŸÑŸÖ ÿßŸÑŸÑŸä ÿ®ÿ™ÿ≠ÿ® ÿ™ÿ™ŸÅÿ±ÿ¨ ÿπŸÑŸäŸá ŸÖÿπÿßŸäÿßÿü","ÿßŸÖÿ™Ÿâ ÿ®ÿ™ÿ≠ÿ≥ ÿßŸÜŸä ÿ®ŸÉŸàŸÜ ÿ≥ŸÜÿØ ŸÑŸäŸÉ ÿ®ÿ¨ÿØÿü"] },
            { id: 'confess', roles: ['friends','couples'], icon: 'ü§ê', q: ["ÿßŸäŸá ÿ£ÿ∫ÿ±ÿ® ŸÖŸÉÿßŸÜ ÿ±Ÿàÿ≠ÿ™ ŸÅŸäŸáÿü","ÿπŸÖÿ±ŸÉ ÿ≥ÿ±ŸÇÿ™ ÿ≠ÿßÿ¨ÿ© (ÿ≠ÿ™Ÿâ ŸÑŸà ŸÑÿ®ÿßŸÜÿ©) ŸàÿßŸÜÿ™ ÿµÿ∫Ÿäÿ±ÿü","ŸÖŸäŸÜ ÿßŸÑÿ¥ÿÆÿµ ÿßŸÑŸÑŸä ŸÜŸÅÿ≥ŸÉ ÿ™ŸÇŸàŸÑŸá 'ÿ¥ŸÉÿ±ÿßŸã'ÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ŸÖŸàŸÇŸÅ ÿ∂ÿ≠ŸÉŸÉ ŸÖÿπ ÿµÿ≠ÿßÿ®ŸÉ ŸàŸÖÿ≥ÿ™ÿ≠ŸäŸÑ ÿ™ŸÜÿ≥ÿßŸáÿü","ÿßŸäŸá ÿßŸÑÿπÿßÿØÿ© ÿßŸÑÿ∫ÿ±Ÿäÿ®ÿ© ÿßŸÑŸÑŸä ÿ®ÿ™ÿπŸÖŸÑŸáÿß ŸàÿßŸÜÿ™ ŸÑŸàÿ≠ÿØŸÉÿü","ŸÑŸà ŸÖÿπÿßŸÉ ÿ∑ÿßŸÇŸäÿ© ÿßŸÑÿ•ÿÆŸÅÿßÿ°ÿå Ÿáÿ™ÿ±Ÿàÿ≠ ŸÅŸäŸÜÿü","ÿπŸÖÿ±ŸÉ ÿπŸÖŸÑÿ™ ŸÖŸÇŸÑÿ® ŸÅŸä ÿ≠ÿØ Ÿàÿ≤ÿπŸÑ ŸÖŸÜŸÉÿü"] },
            { id: 'tell', roles: ['friends','family','all'], icon: 'üì¢', q: ["ÿßÿ≠ŸÉŸäŸÑŸÜÿß ÿπŸÜ ÿπŸÑŸÇÿ© ÿ≥ÿÆŸÜÿ© ÿÆÿØÿ™Ÿáÿß ŸàÿßŸÜÿ™ ÿµÿ∫Ÿäÿ±ÿü","ÿßÿ≠ŸÉŸä ÿπŸÜ ŸäŸàŸÖ ŸÖÿ¥ ŸÖŸÖŸÉŸÜ ÿ™ŸÜÿ≥ÿßŸáÿü","ÿßÿ≠ŸÉŸä ÿπŸÜ ŸÖŸàŸÇŸÅ ŸÖÿ≠ÿ±ÿ¨ ÿ≠ÿµŸÑŸÉ ŸÅŸä ŸÅÿ±ÿ≠ÿü","ÿßÿ≠ŸÉŸä ÿπŸÜ ŸÖŸàŸÇŸÅ ÿÆŸàŸÅŸÉ ÿ¨ÿØÿßŸãÿü","ÿßÿ≠ŸÉŸäŸÑŸÜÿß ÿπŸÜ ŸÖÿ∫ÿßŸÖÿ±ÿ© ÿπŸÖŸÑÿ™Ÿáÿß ŸÅŸä ÿ≥ŸÅÿ±Ÿäÿ©ÿü","ÿßÿ≠ŸÉŸä ÿπŸÜ ÿ£ŸàŸÑ ŸäŸàŸÖ ÿ¥ÿ∫ŸÑ ŸÑŸäŸÉÿü","ÿßÿ≠ŸÉŸä ÿπŸÜ ÿ£ÿ≠ŸÑŸâ ŸáÿØŸäÿ© ÿ¨ÿßÿ™ŸÑŸÉ ŸÅŸä ÿπŸäÿØ ŸÖŸäŸÑÿßÿØŸÉÿü"] },
            // Expanded
            { id: 'career', roles: ['work','friends','all'], icon: 'üíº', q: ["ÿßŸäŸá ÿ£ÿ∫ÿ±ÿ® ÿ¥ÿ∫ŸÑÿßŸÜÿ© ÿßÿ¥ÿ™ÿ∫ŸÑÿ™Ÿáÿß ŸÅŸä ÿ≠Ÿäÿßÿ™ŸÉÿü","ŸÑŸà ÿ®ŸÇŸäÿ™ ŸÖÿØŸäÿ± ÿßŸÑÿ¥ÿ±ŸÉÿ© ŸÑŸÖÿØÿ© ŸäŸàŸÖÿå ÿ£ŸàŸÑ ŸÇÿ±ÿßÿ± Ÿáÿ™ÿßÿÆÿØŸá ÿßŸäŸáÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ÿ≠ÿßÿ¨ÿ© ÿ®ÿ™ŸÅÿµŸÑŸÉ ÿπŸÜ ÿßŸÑÿ¥ÿ∫ŸÑÿü","ŸÖŸäŸÜ ÿßŸÑÿ¥ÿÆÿµ ÿßŸÑŸÑŸä ÿ®ŸäÿÆŸÑŸä ÿßŸÑÿ¥ÿ∫ŸÑ ŸäŸáŸàŸÜ ÿπŸÑŸäŸÉÿü","ŸÑŸà ŸÖÿ¥ ÿ®ÿ™ÿ¥ÿ™ÿ∫ŸÑ ÿ¥ÿ∫ŸÑÿßŸÜÿ™ŸÉ ÿØŸäÿå ŸÉÿßŸÜ ŸÜŸÅÿ≥ŸÉ ÿ™ŸÉŸàŸÜ ÿßŸäŸáÿü","ÿßÿ≠ŸÉŸäŸÑŸÜÿß ÿπŸÜ ŸÖŸàŸÇŸÅ ŸÖÿ∂ÿ≠ŸÉ ÿ≠ÿµŸÑ ŸÅŸä ÿßÿ¨ÿ™ŸÖÿßÿπÿü","ÿßŸäŸá ÿßŸÑÿ≠ÿßÿ¨ÿ© ÿßŸÑŸÑŸä ÿ®ÿ™ÿπŸÖŸÑŸáÿß ÿπÿ¥ÿßŸÜ ÿ™ŸÅŸàŸÇ ŸÅŸä ŸÜÿµ ÿßŸÑŸäŸàŸÖÿü","ŸÑŸà ŸÉÿ≥ÿ®ÿ™ ŸÑŸàÿ™ÿ±Ÿäÿå Ÿáÿ™ŸÉŸÖŸÑ ÿ¥ÿ∫ŸÑ ŸàŸÑÿß Ÿáÿ™ÿ≥ÿ™ŸÇŸäŸÑÿü"] },
            { id: 'travel', roles: ['friends','family','all','couples'], icon: '‚úàÔ∏è', q: ["ŸÑŸà ŸÖÿπÿßŸÉ ÿ™ÿ∞ŸÉÿ±ÿ© ŸÑÿ®ŸÑÿØ Ÿàÿßÿ≠ÿØÿ© ÿ®ÿ≥ÿå Ÿáÿ™ÿÆÿ™ÿßÿ± ŸÅŸäŸÜÿü","ÿ®ÿ™ÿ≠ÿ® ÿ™ÿ≥ÿßŸÅÿ± ŸÑŸàÿ≠ÿØŸÉ ŸàŸÑÿß ŸÖÿπ ÿ¥ŸÑÿ©ÿü","ÿßŸäŸá ÿ£ÿ≥Ÿàÿ£ ÿ™ÿ¨ÿ±ÿ®ÿ© ÿ≠ÿµŸÑÿ™ŸÑŸÉ ŸÅŸä ÿ≥ŸÅÿ±Ÿäÿ©ÿü","ÿØŸáÿ® ŸàŸÑÿß ÿßŸÑÿ≥ÿßÿ≠ŸÑÿü ŸàŸÑŸäŸáÿü","ÿßŸäŸá ÿßŸÑÿ≠ÿßÿ¨ÿ© ÿßŸÑŸÑŸä ÿØÿßŸäŸÖÿß ÿ®ÿ™ŸÜÿ≥ÿßŸáÿß ŸàÿßŸÜÿ™ ÿ®ÿ™ÿ≠ÿ∂ÿ± ÿ¥ŸÜÿ∑ÿ™ŸÉÿü","ÿ®ÿ™ÿ≠ÿ® ÿßŸÑÿ®ÿ≠ÿ± ŸàÿßŸÑÿßÿ≥ÿ™ÿ¨ŸÖÿßŸÖ ŸàŸÑÿß ÿßŸÑÿ¨ÿ®ÿßŸÑ ŸàÿßŸÑŸÖÿ∫ÿßŸÖÿ±ÿ©ÿü","ÿßÿ≠ŸÉŸäŸÑŸÜÿß ÿπŸÜ ŸÖŸÉÿßŸÜ ÿ±Ÿàÿ≠ÿ™ŸÑŸá ŸàŸÜŸÅÿ≥ŸÉ ÿ™ÿ±Ÿàÿ≠Ÿá ÿ™ÿßŸÜŸäÿü","ŸÑŸà Ÿáÿ™ÿπŸäÿ¥ ŸÅŸä ÿ®ŸÑÿØ ÿ™ÿßŸÜŸäÿ© ÿ∫Ÿäÿ± ŸÖÿµÿ±ÿå ÿ™ÿÆÿ™ÿßÿ± ŸÅŸäŸÜÿü"] },
            { id: 'whatif', roles: ['friends','couples','all','family','work'], icon: 'üîÆ', q: ["ŸÑŸà ÿ®ŸÇŸäÿ™ Ÿàÿ≤Ÿäÿ± ÿßŸÑÿ≥ÿπÿßÿØÿ©ÿå ÿ£ŸàŸÑ ŸÇÿ±ÿßÿ± Ÿáÿ™ÿßÿÆÿØŸá ÿßŸäŸáÿü","ŸÑŸà ŸÖÿπÿßŸÉ ÿ¢ŸÑÿ© ÿ≤ŸÖŸÜÿå Ÿáÿ™ÿ±ÿ¨ÿπ ŸÑŸÑŸÖÿßÿ∂Ÿä ŸàŸÑÿß ÿ™ÿ±Ÿàÿ≠ ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑÿü","ŸÑŸà ÿµÿ≠Ÿäÿ™ ŸÑŸÇŸäÿ™ ŸÜŸÅÿ≥ŸÉ ÿßŸÑÿ¥ÿÆÿµ ÿßŸÑŸàÿ≠ŸäÿØ ÿπŸÑŸâ ŸÉŸàŸÉÿ® ÿßŸÑÿ£ÿ±ÿ∂ÿü","ŸÑŸà ÿ™ŸÇÿØÿ± ÿ™ÿßÿÆÿØ ŸÇÿØÿ±ÿ© ÿÆÿßÿ±ŸÇÿ© Ÿàÿßÿ≠ÿØÿ©ÿå ÿ™ÿÆÿ™ÿßÿ± ÿßŸäŸáÿü (ÿ∑Ÿäÿ±ÿßŸÜÿå ÿßÿÆÿ™ŸÅÿßÿ°ÿå ŸÇÿ±ÿßÿ°ÿ© ÿ£ŸÅŸÉÿßÿ±)","ŸÑŸà ÿ≠Ÿäÿßÿ™ŸÉ Ÿáÿ™ÿ™ÿ≠ŸàŸÑ ŸÑŸÅŸäŸÑŸÖÿå ŸÖŸäŸÜ ÿßŸÑŸÖŸÖÿ´ŸÑ ÿßŸÑŸÑŸä ŸáŸäŸÇŸàŸÖ ÿ®ÿØŸàÿ±ŸÉÿü","ŸÑŸà ÿ™ŸÇÿØÿ± ÿ™ÿßŸÉŸÑ ÿ£ŸÉŸÑÿ© Ÿàÿßÿ≠ÿØÿ© ÿ®ÿ≥ ÿ®ŸÇŸäÿ© ÿ≠Ÿäÿßÿ™ŸÉÿå Ÿáÿ™ŸÉŸàŸÜ ÿßŸäŸáÿü","ŸÑŸà ÿßŸÑÿ≠ŸäŸàÿßŸÜÿßÿ™ ÿ®ÿ™ÿ™ŸÉŸÑŸÖÿå ÿ™ŸÅÿ™ŸÉÿ± ŸÖŸäŸÜ ŸáŸäŸÉŸàŸÜ ÿ£ÿ±ÿÆŸÖ ÿ≠ŸäŸàÿßŸÜÿü"] },
            { id: 'debate', roles: ['friends','family','work','all','couples'], icon: '‚öñÔ∏è', q: ["ÿ®ÿ™ÿ≠ÿ® ÿßŸÑÿ¥ÿßŸä ÿ®ÿ≠ŸÑŸäÿ® ŸàŸÑÿß ÿßŸÑŸÇŸáŸàÿ© ÿßŸÑÿµÿ®ÿ≠ÿü","ÿ¥ÿßŸäŸÅ ÿßŸÑÿ¨Ÿàÿßÿ≤ ÿπŸÜ ÿ≠ÿ® ŸàŸÑÿß ÿµÿßŸÑŸàŸÜÿßÿ™ ÿ£ŸÜÿ¨ÿ≠ÿü","ÿπŸÖÿ±Ÿà ÿØŸäÿßÿ® ŸàŸÑÿß ÿ™ÿßŸÖÿ± ÿ≠ÿ≥ŸÜŸäÿü","ÿßŸÑŸÅŸÑŸàÿ≥ ŸàŸÑÿß ÿ±ÿßÿ≠ÿ© ÿßŸÑÿ®ÿßŸÑÿü","ÿßŸÑÿ£ŸäŸÅŸàŸÜ ŸàŸÑÿß ÿßŸÑÿ£ŸÜÿØÿ±ŸàŸäÿØÿü","ÿßŸÑÿ£ŸÉŸÑ ÿßŸÑÿ®Ÿäÿ™Ÿä ŸàŸÑÿß ÿ£ŸÉŸÑ ÿßŸÑÿ¥ÿßÿ±ÿπÿü","ÿßŸÑÿ≥ÿßÿ≠ŸÑ ÿßŸÑÿ∑Ÿäÿ® ŸàŸÑÿß ÿßŸÑÿ≥ÿßÿ≠ŸÑ ÿßŸÑÿ¥ÿ±Ÿäÿ±ÿü","ÿ®ÿ™ÿ≠ÿ® ÿ™ŸÇÿπÿØ ŸÅŸä ÿßŸÑÿ®Ÿäÿ™ ŸàŸÑÿß ÿ™ÿÆÿ±ÿ¨ÿü","ÿ¥ŸÉÿ¥ŸàŸÉÿ© ÿ®ÿµŸÑ ŸàŸÑÿß ÿ™ŸàŸÖÿü","ÿ™ÿ±ÿ®Ÿä ŸÉŸÑÿ® ŸàŸÑÿß ŸÇÿ∑ÿ©ÿü"] },
            // Requested Additions (Unique Questions)
            { id: 'truth', roles: ['friends','couples','family'], icon: 'üëÅÔ∏è', q: ["ÿ¥ÿßŸäŸÅ ŸÅŸäÿß ÿπŸäÿ® ÿßŸäŸá ŸÜŸÅÿ≥Ÿä ÿ£ÿ∫Ÿäÿ±Ÿáÿü","ÿßŸÖÿ™Ÿâ ÿ≠ÿ≥Ÿäÿ™ ÿßŸÜŸä ÿÆÿ∞ŸÑÿ™ŸÉÿü","ŸÖŸäŸÜ ÿ£ŸÉÿ™ÿ± ÿ¥ÿÆÿµ ŸÅŸä ÿßŸÑŸÇÿπÿØÿ© ÿØŸä ÿ®Ÿäÿπÿ±ŸÅ Ÿäÿ≥ŸÖÿπŸÉÿü","ÿßŸäŸá ÿßŸÑÿµŸÅÿ© ÿßŸÑŸÑŸä ŸÅŸäŸÉ ŸàŸÜŸÅÿ≥ŸÉ ÿ™ÿ∫Ÿäÿ±Ÿáÿßÿü","ŸÖŸäŸÜ ÿ£ŸÉÿ™ÿ± ÿ≠ÿØ ÿ®ÿ™ÿ´ŸÇ ŸÅŸäŸá ŸÅŸä ÿ≠Ÿäÿßÿ™ŸÉÿü","ŸÑŸà Ÿáÿ™ŸàÿµŸÅ ŸÜŸÅÿ≥ŸÉ ÿ®ŸÉŸÑŸÖÿ© Ÿàÿßÿ≠ÿØÿ©ÿå Ÿáÿ™ŸÉŸàŸÜ ÿßŸäŸáÿü","ÿßŸäŸá ÿ£ŸÉÿ™ÿ± ÿ≠ÿßÿ¨ÿ© ÿ®ÿ™ŸÜÿØŸÖ ÿπŸÑŸäŸáÿßÿü"] },
            { id: 'context', roles: ['friends','all','couples','family'], icon: 'üí°', q: ["ŸÑŸÖÿß ÿ£ŸÇŸàŸÑ 'ÿ¨Ÿàÿßÿ≤'ÿå ÿßŸäŸá ÿ£ŸàŸÑ ŸÉŸÑŸÖÿ© ÿ®ÿ™Ÿäÿ¨Ÿä ŸÅŸä ÿ®ÿßŸÑŸÉÿü","ÿ≥ŸäÿßŸÇ: 'ŸäŸàŸÖ ÿßŸÑÿ¨ŸÖÿπÿ©'. ÿ®ÿ™ŸÅŸÉÿ± ŸÅŸä ÿßŸäŸáÿü","ŸÉŸÑŸÖÿ© 'ŸÜÿ¨ÿßÿ≠' ÿ®ÿ™ŸÖÿ´ŸÑŸÉ ŸÖŸäŸÜÿü","ÿ≥ŸäÿßŸÇ: 'ÿßŸÑŸÅŸÑŸàÿ≥'. ŸÉŸÖŸÑ ÿßŸÑÿ¨ŸÖŸÑÿ© ÿ®ŸÉŸÑŸÖÿ© Ÿàÿßÿ≠ÿØÿ©.","ŸÑŸÖÿß ÿ®ÿ™ÿ≥ŸÖÿπ ÿßÿ≥ŸÖ 'ŸÖÿµÿ±'ÿå ÿ®ÿ™ŸÅÿ™ŸÉÿ± ÿßŸäŸáÿü","ÿ≥ŸäÿßŸÇ: 'ÿßŸÑÿ∫ÿØÿ±'. ÿ£ŸàŸÑ ŸÖŸàŸÇŸÅ ÿ¨Ÿá ŸÅŸä ÿ®ÿßŸÑŸÉÿü"] },
            { id: 'wishes', roles: ['friends','all','couples','family'], icon: '‚ú®', q: ["ÿßŸäŸá ÿßŸÑÿ£ŸÖŸÜŸäÿ© ÿßŸÑŸÑŸä ÿßÿ™ŸÖŸÜŸäÿ™Ÿáÿß ŸàŸÖÿ™ÿ≠ŸÇŸÇÿ™ÿ¥ ŸàŸÑÿπŸÑŸáÿß ÿÆŸäÿ±ÿü","ŸÜŸÅÿ≥ŸÉ ÿ±ÿ®ŸÜÿß Ÿäÿ±ÿ≤ŸÇŸÉ ÿ®ÿßŸäŸá ÿßŸÑÿ≥ŸÜÿ© ÿØŸäÿü","ÿ™ÿ™ŸÖŸÜŸâ ŸÖŸäŸÜ Ÿäÿ≥ÿßŸÖÿ≠ŸÉÿü","ŸÑŸà ŸÑŸäŸÉ ÿ£ŸÖŸÜŸäÿ© Ÿàÿßÿ≠ÿØÿ© ÿ™ÿ™ÿ≠ŸÇŸÇ ÿØŸÑŸàŸÇÿ™Ÿä ÿ≠ÿßŸÑÿßŸãÿå Ÿáÿ™ŸÉŸàŸÜ ÿßŸäŸáÿü","ŸÜŸÅÿ≥ŸÉ ÿ™ŸÉŸàŸÜ ŸÅŸäŸÜ ŸÉŸÖÿßŸÜ Ÿ°Ÿ† ÿ≥ŸÜŸäŸÜÿü","ÿßŸäŸá ÿßŸÑÿ≠ÿßÿ¨ÿ© ÿßŸÑŸÑŸä ŸÜŸÅÿ≥ŸÉ ÿ™ÿ¥ÿ™ÿ±ŸäŸáÿß ÿ®ÿ≥ ÿ∫ÿßŸÑŸäÿ© ÿπŸÑŸäŸÉÿü"] },
            { id: 'advice', roles: ['friends','family','all'], icon: 'üïå', q: ["ŸÜÿµŸäÿ≠ÿ© ÿØŸäŸÜŸäÿ© ŸÅÿ±ŸÇÿ™ ŸÖÿπÿßŸÉ ŸÅŸä ÿ≠Ÿäÿßÿ™ŸÉÿü","ÿßŸäŸá ÿßŸÑÿ¢Ÿäÿ© ÿßŸÑŸÑŸä ŸÑŸÖÿß ÿ®ÿ™ÿ≥ŸÖÿπŸáÿß ŸÇŸÑÿ®ŸÉ ÿ®Ÿäÿ±ÿ™ÿßÿ≠ÿü","ŸÑŸà Ÿáÿ™ŸÜÿµÿ≠ŸÜÿß ŸÜÿµŸäÿ≠ÿ© Ÿàÿßÿ≠ÿØÿ© ÿπÿ¥ÿßŸÜ ŸÜŸÇÿ±ÿ® ŸÖŸÜ ÿ±ÿ®ŸÜÿßÿå Ÿáÿ™ŸÇŸàŸÑ ÿßŸäŸáÿü","ÿßŸäŸá ÿßŸÑÿπÿßÿØÿ© ÿßŸÑÿØŸäŸÜŸäÿ© ÿßŸÑŸÑŸä ŸÜŸÅÿ≥ŸÉ ÿ™Ÿàÿßÿ∏ÿ® ÿπŸÑŸäŸáÿßÿü","ÿßÿ≤ÿßŸä ÿ®ÿ™ÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ÿßŸÑÿßÿ®ÿ™ŸÑÿßÿ°ÿü","ŸÖŸäŸÜ ÿßŸÑÿ¥ŸäÿÆ ÿßŸÑŸÑŸä ÿ®ÿ™ÿ≠ÿ® ÿ™ÿ≥ŸÖÿπ ÿµŸàÿ™Ÿá ŸÅŸä ÿßŸÑŸÇÿ±ÿ¢ŸÜÿü"] }
        ];

        // NO MAPPING - Use Raw Unique Arrays
        const categoriesDB = baseCats;

        let state = {
            uiLang: 'en', mode: 'dark', theme: 'galaxy', 
            role: 'friends', targetCount: 30, currentCatId: null, deck: [], history: [], currentIndex: -1
        };

        $(document).ready(() => {
            initParticles();
            $('#btn-lang-en').addClass('active');
            updateUI();
        });

        function enterApp() {
            $('#screen-landing').addClass('animate__fadeOutUp');
            setTimeout(() => { $('#screen-landing').removeClass('active'); showScreen('screen-setup'); }, 500);
        }

        function showScreen(id) { $('.screen').removeClass('active'); $(`#${id}`).addClass('active'); }
        function toggleSettings() { const m = $('#modal-settings'); if(m.is(':visible')) m.fadeOut(); else m.fadeIn().css('display','flex'); }

        function setCount(n) { state.targetCount = n; $('.count-btn').removeClass('active').filter((i,e)=>$(e).text()==n).addClass('active'); haptic(); }
        function setRole(r) { state.role = r; $('.role-btn').removeClass('selected'); $(`#role-${r}`).parent().addClass('selected'); haptic(); setTimeout(() => { renderCats(); showScreen('screen-cats'); }, 250); }

        function renderCats() {
            const c = $('#categories-container'); c.empty();
            const l = uiDict[state.uiLang].cats;
            const valid = categoriesDB.filter(x => x.roles.includes(state.role));
            c.append(`<div class="col-6 col-md-4"><div class="ui-panel p-3 text-center h-100 d-flex flex-column justify-content-center" onclick="startGame('random')" style="cursor:pointer;border-bottom:4px solid var(--text-main)"><div class="display-3 mb-2">üé≤</div><h5 class="fw-bold m-0">${l.rand}</h5></div></div>`);
            valid.forEach(i => {
                c.append(`<div class="col-6 col-md-4"><div class="ui-panel p-3 text-center h-100 d-flex flex-column justify-content-center" onclick="startGame('${i.id}')" style="cursor:pointer;border-bottom:4px solid var(--accent)"><div class="display-3 mb-2">${i.icon}</div><h5 class="fw-bold m-0">${l[i.id]||i.id}</h5></div></div>`);
            });
        }

        function startGame(id) {
            state.currentCatId = id;
            let pool = [];
            
            // Gather Unique Questions
            if(id === 'random') {
                categoriesDB.filter(x => x.roles.includes(state.role)).forEach(x => {
                    pool = [...pool, ...x.q];
                });
            } else {
                const cat = categoriesDB.find(x => x.id === id);
                if(cat) pool = [...cat.q];
            }
            
            // Remove duplicates just in case random mix has overlaps
            pool = [...new Set(pool)];

            // Shuffle Unique Questions
            pool.sort(()=>Math.random()-0.5);
            
            // Slice Deck (If pool is smaller than target, take all pool)
            if(pool.length < state.targetCount) {
                state.deck = pool;
            } else {
                state.deck = pool.slice(0, state.targetCount);
            }

            state.history = []; state.currentIndex = -1;
            showScreen('screen-game');
            $('#game-cat-title').text(id==='random' ? uiDict[state.uiLang].cats.rand : uiDict[state.uiLang].cats[id]);
            nextCard();
        }

        function renderCard(txt, end=false) {
            const s = $('#card-stage'); s.empty();
            s.append(`<div class="game-card animate__animated animate__zoomIn"><h2 class="card-title" style="direction:rtl">${txt}</h2></div>`);
            if(end) $('#btn-next').hide(); else $('#btn-next').show();
            
            // Fix progress calculation
            const total = state.deck.length; // Use actual deck length, not target count (in case unique count < target)
            const current = state.currentIndex + 1;
            const pct = (current/total)*100;
            
            $('#game-progress').css('width', `${pct}%`);
            $('#counter').text(`${current} / ${total}`);
        }

        function nextCard() {
            haptic();
            if(state.currentIndex < state.history.length-1) { 
                state.currentIndex++; 
                renderCard(state.history[state.currentIndex]); 
            }
            else if(state.history.length < state.deck.length) {
                const q = state.deck[state.history.length]; 
                state.history.push(q); 
                state.currentIndex++; 
                renderCard(q);
            } else {
                showDialog(uiDict[state.uiLang].game_over, uiDict[state.uiLang].game_over_msg, () => showScreen('screen-setup'), true);
            }
            updateNav();
        }

        function prevCard() { haptic(); if(state.currentIndex > 0) { state.currentIndex--; renderCard(state.history[state.currentIndex]); updateNav(); } }
        function updateNav() {
            if(state.currentIndex <= 0) $('#btn-prev').css({opacity:0.5, pointerEvents:'none'}); else $('#btn-prev').css({opacity:1, pointerEvents:'all'});
            
            const isEnd = state.currentIndex >= state.deck.length - 1;
            $('#btn-next').text(isEnd ? uiDict[state.uiLang].finish : uiDict[state.uiLang].next);
        }

        function toggleMode() { state.mode = state.mode==='dark'?'light':'dark'; $('body').attr('data-mode', state.mode); $('#toggle-mode').toggleClass('active'); haptic(); }
        function setTheme(t,el) { state.theme=t; $('body').attr('data-theme',t); $('.theme-btn').removeClass('active'); $(el).addClass('active'); haptic(); }
        
        function setUILang(l) { 
            state.uiLang=l; 
            $('.lang-btn').removeClass('active'); $(`#btn-lang-${l}`).addClass('active');
            updateUI(); if($('#screen-cats').hasClass('active'))renderCats(); haptic();
        }

        function updateUI() {
            const t = uiDict[state.uiLang];
            $('body').attr('dir', state.uiLang==='ar'?'rtl':'ltr');
            $('#txt-start').text(t.start_btn);
            $('#lbl-setup-title').text(t.setup_title); $('#lbl-setup-desc').text(t.setup_desc);
            $('#lbl-count').text(t.lbl_count); $('#lbl-role').text(t.lbl_role);
            $('#role-friends').text(t.roles.friends); $('#role-couples').text(t.roles.couples); $('#role-family').text(t.roles.family); $('#role-work').text(t.roles.work); $('#role-all').text(t.roles.all);
            $('#btn-settings-link').text(t.btn_settings);
            $('#lbl-settings-modal').text(t.settings_modal); $('#lbl-mode').text(t.mode); $('#lbl-theme').text(t.theme); $('#lbl-ui-lang').text(t.ui_lang);
            updateNav();
        }

        function showDialog(title, msg, onConfirm, showCancel = true) {
            $('#d-title').text(title); $('#d-msg').text(msg);
            const btnOk = $('#d-btn-ok'); const btnCancel = $('#d-btn-cancel');
            btnOk.text(uiDict[state.uiLang].yes); btnCancel.text(uiDict[state.uiLang].no);
            if(!showCancel) { btnCancel.hide(); btnOk.text(uiDict[state.uiLang].ok); } else btnCancel.show();
            btnOk.off('click').on('click', function() { closeDialog(); if(onConfirm) onConfirm(); });
            $('#custom-dialog').css('display', 'flex');
        }
        function closeDialog() { $('#custom-dialog').hide(); }
        function confirmExit() { showDialog(uiDict[state.uiLang].exit_confirm, "", () => showScreen('screen-setup'), true); }
        function initParticles() { const c = $('#particles'); for(let i=0; i<15; i++) { const s = Math.random()*4+2; c.append(`<div style="position:absolute; width:${s}px; height:${s}px; background:white; border-radius:50%; opacity:0.3; left:${Math.random()*100}%; bottom:-20px; animation:float ${Math.random()*10+5}s linear infinite"></div>`); } }
        function haptic() { if(navigator.vibrate) navigator.vibrate(10); }
    </script>
</body>
</html>