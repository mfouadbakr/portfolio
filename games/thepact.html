<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Pact | ุงูููุซุงู</title>
    
    <!-- Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Montserrat:wght@500;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #121212;
            --panel-bg: #1e1e1e;
            --text-main: #ffffff;
            --text-sub: #aaaaaa;
            --border-color: #333333;
            --accent: #DC143C; /* Crimson */
            --card-bg: #252525;
        }

        /* LOCK VIEWPORT - GLOBAL */
        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; 
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Montserrat', sans-serif;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .ar-font { font-family: 'Cairo', sans-serif; direction: rtl; }

        /* --- BACKGROUND --- */
        #snow-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none;
        }

        .floating-heart {
            position: absolute;
            color: var(--accent);
            opacity: 0.15;
            font-size: 3rem;
            animation: floatUp 15s linear infinite;
            z-index: 0;
            text-shadow: 0 0 10px var(--accent);
        }
        
        .h1 { left: 10%; bottom: -100px; animation-delay: 0s; font-size: 2rem; }
        .h2 { left: 80%; bottom: -100px; animation-delay: 5s; font-size: 4rem; }
        .h3 { left: 40%; bottom: -100px; animation-delay: 10s; font-size: 3rem; }

        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            20% { opacity: 0.3; }
            100% { transform: translateY(-120vh) rotate(360deg); opacity: 0; }
        }

        /* --- SCREENS --- */
        .screen { 
            display: none; 
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            flex-direction: column; 
            padding: 20px;
            z-index: 10;
            box-sizing: border-box;
        }
        
        .screen.active { display: flex !important; animation: fadeIn 0.4s; }

        /* CENTER WRAPPER */
        .center-wrapper {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        /* --- SCROLLABLE LIST CONTAINER (Only for Episodes) --- */
        .scroll-container {
            flex-grow: 1; 
            overflow-y: auto; 
            width: 100%;
            padding-bottom: 20px;
            scrollbar-width: none; 
            -ms-overflow-style: none;
        }
        .scroll-container::-webkit-scrollbar { display: none; }

        /* --- UI COMPONENTS --- */
        
        /* CLEAN BUTTON (No Glow, No Pulse) */
        .btn-solid {
            background: var(--accent); color: var(--text-main);
            border: none; padding: 15px 40px;
            font-size: 1.1rem; font-weight: 900;
            border-radius: 50px;
            text-transform: uppercase;
            cursor: pointer; transition: 0.2s;
            width: 100%; max-width: 300px;
            flex-shrink: 0;
            box-shadow: none; /* Removed Glow */
        }
        .btn-solid:active { transform: scale(0.96); opacity: 0.9; }

        .btn-icon { background: none; border: none; color: var(--text-main); font-size: 1.5rem; cursor: pointer; padding: 10px; }
        
        /* Episode Cards */
        .mode-card {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-left: 4px solid var(--accent);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer; transition: 0.2s;
            display: flex; align-items: center; justify-content: space-between;
            min-height: 90px;
            margin-bottom: 15px;
        }
        .mode-card:active { transform: scale(0.98); background: #2a2a2a; }
        
        /* --- GAME CARD (The Fix for No Scroll) --- */
        .game-stage {
            flex-grow: 1; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center;
            width: 100%;
            overflow: hidden; /* Prevent stage scroll */
        }
        
        .main-card {
            width: 100%; max-width: 500px; 
            max-height: 85vh; 
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            padding: 25px; 
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .card-content {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Choice Buttons (Fixed to expand) */
        .choice-btn {
            background: var(--bg-color); border: 1px solid var(--border-color);
            border-radius: 12px; 
            padding: 15px; 
            width: 100%;
            cursor: pointer; transition: 0.2s;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; color: var(--text-main);
            
            /* Text Handling */
            min-height: 60px; 
            height: auto; 
            white-space: normal; 
            word-break: break-word;
            line-height: 1.4;
            font-size: 1rem;
        }
        
        .choice-btn:active {
            background: var(--accent); border-color: var(--accent);
        }

        .gap-custom { gap: 15px; }

        .progress-track { flex-grow: 1; height: 4px; background: var(--border-color); border-radius: 10px; margin: 0 20px; }
        .progress-bar { height: 100%; background: var(--accent); width: 0%; border-radius: 10px; transition: width 0.3s; }

        /* Judgement Selection */
        .judge-option {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 12px;
            cursor: pointer;
            transition: 0.2s;
            text-align: center;
        }
        .judge-option:hover { border-color: var(--accent); }

        /* Footer */
        .dev-credit {
            margin-top: 20px; width: 100%; text-align: center;
            font-size: 0.7rem; color: var(--text-sub);
            flex-shrink: 0;
        }
        .dev-credit a { color: var(--accent); text-decoration: none; font-weight: bold; }

    </style>
</head>
<body>

    <!-- BACKGROUND -->
    <canvas id="snow-canvas"></canvas>
    <div class="floating-heart h1">โฅ</div>
    <div class="floating-heart h2">โฅ</div>
    <div class="floating-heart h3">โฅ</div>

    <!-- 1. LANDING -->
    <div id="screen-landing" class="screen active">
        <div class="center-wrapper">
            <h1 class="display-1 fw-bold mb-0 animate__animated animate__fadeInDown" style="color:var(--text-main);">THE PACT</h1>
            <h3 class="animate__animated animate__fadeInUp" style="color:var(--accent); margin-top: -10px;">ุงูููุซุงู</h3>
            <p class="text-sub mb-5 animate__animated animate__fadeInUp" style="letter-spacing: 2px; margin-top:20px;">COUPLES EDITION</p>
            
            <!-- BUTTON (NO ANIMATION, NO GLOW) -->
            <button class="btn-solid animate__animated animate__fadeInUp" onclick="showScreen('screen-episodes')">
                START JOURNEY
            </button>

            <div class="dev-credit">
                Developed by <a href="https://mfouadbakr.github.io/portfolio/" target="_blank">Mohamed Bakr</a>
            </div>
        </div>
    </div>

    <!-- 2. EPISODE SELECTION (SCROLLABLE) -->
    <div id="screen-episodes" class="screen">
        <div class="d-flex justify-content-between align-items-center mb-4" style="flex-shrink: 0;">
            <button class="btn-icon" onclick="showScreen('screen-landing')">โ</button>
            <h3 class="m-0 fw-bold">SELECT TOPIC</h3>
            <div style="width: 40px;"></div>
        </div>

        <div class="scroll-container">
            
            <div class="mode-card" onclick="startGame('work_man')">
                <div class="d-flex align-items-center gap-3">
                    <span style="font-size:2rem;">๐</span>
                    <div>
                        <div class="fw-bold">The Man's Burden</div>
                        <div class="text-sub" style="font-size:0.8rem;">Work Stress & Pressure</div>
                    </div>
                </div>
                <span style="color:var(--accent)">โค</span>
            </div>

            <div class="mode-card" onclick="startGame('personality')">
                <div class="d-flex align-items-center gap-3">
                    <span style="font-size:2rem;">๐ง</span>
                    <div>
                        <div class="fw-bold">Personality & Temper</div>
                        <div class="text-sub" style="font-size:0.8rem;">How we react</div>
                    </div>
                </div>
                <span style="color:var(--accent)">โค</span>
            </div>

            <div class="mode-card" onclick="startGame('wedding')">
                <div class="d-flex align-items-center gap-3">
                    <span style="font-size:2rem;">๐</span>
                    <div>
                        <div class="fw-bold">Wedding Plans</div>
                        <div class="text-sub" style="font-size:0.8rem;">Budget & Choices</div>
                    </div>
                </div>
                <span style="color:var(--accent)">โค</span>
            </div>

            <div class="mode-card" onclick="startGame('home')">
                <div class="d-flex align-items-center gap-3">
                    <span style="font-size:2rem;">๐ก</span>
                    <div>
                        <div class="fw-bold">Future Home</div>
                        <div class="text-sub" style="font-size:0.8rem;">Routine & Life</div>
                    </div>
                </div>
                <span style="color:var(--accent)">โค</span>
            </div>

            <div class="mode-card" onclick="startGame('crisis')">
                <div class="d-flex align-items-center gap-3">
                    <span style="font-size:2rem;">๐ช๏ธ</span>
                    <div>
                        <div class="fw-bold">Handling Crisis</div>
                        <div class="text-sub" style="font-size:0.8rem;">Support & Loyalty</div>
                    </div>
                </div>
                <span style="color:var(--accent)">โค</span>
            </div>

        </div>
    </div>

    <!-- 3. GAMEPLAY (NO SCROLL) -->
    <div id="screen-game" class="screen">
        <!-- Top Bar (Fixed) -->
        <div class="d-flex align-items-center justify-content-between w-100 py-3" style="flex-shrink: 0;">
            <button class="btn-icon" onclick="showScreen('screen-episodes')">โ</button>
            <div class="progress-track"><div class="progress-bar" id="progress-bar"></div></div>
            <div class="fw-bold" id="counter">1/15</div>
        </div>

        <!-- Flexible Card Stage -->
        <div class="game-stage">
            <div id="game-card" class="main-card animate__animated">
                <div class="card-content" id="card-content">
                    <!-- Injected Content -->
                </div>
            </div>
        </div>
        
        <div class="text-center py-3 text-sub" style="flex-shrink: 0;">Discuss & Choose Together</div>
    </div>

    <!-- 4. CONCLUSION (Result) -->
    <div id="screen-conclusion" class="screen">
        <div class="center-wrapper text-center">
            <h2 style="color:var(--accent); letter-spacing: 2px;">THE CONCLUSION</h2>
            <div class="ar-font fw-bold my-4" style="font-size:1.5rem; line-height: 1.6;" id="conclusion-text">
                Loading...
            </div>
            <button class="btn-solid" onclick="showWhoJudges()">Proceed to Judgement</button>
        </div>
    </div>

    <!-- 5. WHO JUDGES? -->
    <div id="screen-who-judges" class="screen">
        <div class="center-wrapper text-center">
            <h2 class="mb-5">WHO DECIDES THE PACT?</h2>
            
            <div class="d-flex flex-column gap-3 w-100 align-items-center">
                <button class="btn-solid" style="background:var(--panel-bg); border:2px solid var(--accent);" onclick="pickJudgements('MAN')">
                    THE MAN
                </button>
                <div class="text-sub">OR</div>
                <button class="btn-solid" style="background:var(--panel-bg); border:2px solid var(--accent);" onclick="pickJudgements('WOMAN')">
                    THE WOMAN
                </button>
            </div>
        </div>
    </div>

    <!-- 6. PICK JUDGEMENT -->
    <div id="screen-pick" class="screen">
        <div class="text-center my-4" style="flex-shrink: 0;">
            <h3 class="fw-bold" style="color:var(--accent)">CHOOSE A PROMISE</h3>
            <p class="text-sub">The other person must commit to this.</p>
        </div>

        <!-- Scrollable List if needed (though 3 items usually fit) -->
        <div id="judgement-list" class="scroll-container d-flex flex-column gap-3 pb-5">
            <!-- 3 Random Options -->
        </div>
    </div>

    <!-- 7. FINAL SCREEN -->
    <div id="screen-final" class="screen">
        <div class="center-wrapper text-center">
            <div style="font-size:4rem; margin-bottom:20px;">๐</div>
            <h2 class="fw-bold mb-4">THE PACT IS SEALED</h2>
            <div class="ar-font fw-bold mb-5" style="font-size:1.3rem; color:var(--accent); line-height:1.6;" id="final-verdict-text">
                ...
            </div>
            <button class="btn-solid" onclick="showScreen('screen-episodes')">New Topic</button>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // --- DATA (EGYPTIAN ARABIC) ---
        const db = {
            work_man: [
                { q: "ุงูุฑุงุฌู ุฑุฌุน ูู ุงูุดุบู 'ููููู' ููุด ุนุงูุฒ ูุชููู. ุงูุณุช ุชุนูู ุฅููุ", opts: [{t:"ุชุณูุจู ูู ุญุงูู ูุญุฏ ูุง ููู", v:"space"}, {t:"ุชูุนุฏ ุฌูุจู ูุชุณุฃูู ูุงูู ุจุฅูุญุงุญ", v:"support"}] },
                { q: "ุงููุฏูุฑ ูู ุงูุดุบู ุถุบุท ุนููู ุฌุฏุงู ูุฑุฌุน ูุชูุฑูุฒ ุนูู ุฃูู ุงูุจูุช.", opts: [{t:"ุงูุณุช ุชุณุชุญูู ูุชูุฏุฑ ุธุฑูู", v:"support"}, {t:"ุชุงุฎุฏ ูููู ุฅูู ุจููุตู ุจูู ุงูุดุบู ูุงูุจูุช", v:"balance"}] },
                { q: "ุฌุงูู ุดุบู ุฅุถุงูู ูู ุงูููู ุฅูุฏ ุจูููุณ ูููุณุฉุ ุจุณ ุฏู ููุช ุงูุจูุช.", opts: [{t:"ููุงูู ุนุดุงู ูุฒูุฏ ุงูุฏุฎู", v:"hustle"}, {t:"ูุฑูุถ ุนุดุงู ุฑุงุญุชู ูุฑุงุญุฉ ุงูุจูุช", v:"balance"}] },
                { q: "ุงูุฑุงุฌู ุจูุดุชูู ูู ุงูุดุบู ูู ููู. ุงูุณุช ุชุนูู ุฅููุ", opts: [{t:"ุชุณูุนู ูุชุทุจุทุจ ุนููู (ุชูุฑูุบ)", v:"support"}, {t:"ุชุฏููู ุญููู ุนูููุฉ ููุตุงูุญ", v:"logic"}] },
                { q: "ุนูุฏู ูุฑุตุฉ ููุชุญ ูุดุฑูุน ุฎุงุต ุจุณ ูุฎุงุทุฑุฉ ูุจูุฑุฉ.", opts: [{t:"ุงูุณุช ุชุดุฌุนู ูุชุบุงูุฑ ูุนุงู", v:"hustle"}, {t:"ุชุฎุงู ุนูู ุงุณุชูุฑุงุฑ ุงูุจูุช ูุชููุนู", v:"balance"}] },
                { q: "ุงูุฑุงุฌู ุญุงุณุณ ุฅูู ููุตุฑ ูุงุฏูุงู ููุถุบูุท ููุณูุงู.", opts: [{t:"ูุฎุจู ูุดุงุนุฑู ููุดุชุบู ุฃูุชุฑ", v:"hustle"}, {t:"ูุตุงุฑุญ ุงูุณุช ููุทูุจ ุฏุนููุง ุงูููุณู", v:"support"}] },
                { q: "ููุงููุฉ ุดุบู ุฌุช ูุฅุญูุง ูู ุฎุฑูุฌุฉ ุญููุฉ.", opts: [{t:"ูุฑุฏ ุนุดุงู ุงูุดุบู ูุจูุณุชูุงุด", v:"hustle"}, {t:"ูููุณู ุนุดุงู ุฏู ููุชูุง ุงูุฎุงุต", v:"balance"}] },
                { q: "ุงููุฑุชุจ ุฎูุต ูุจู ุขุฎุฑ ุงูุดูุฑ ุจุณุจุจ ุงูุชุฒุงูุงุช.", opts: [{t:"ูุณุชูู ูู ุบูุฑ ูุง ูููู ููุณุช", v:"space"}, {t:"ููุนุฏูุง ุณูุง ูุนูุฏูุง ุชูุณูู ุงููุตุงุฑูู", v:"logic"}] },
                { q: "ุงูุฑุงุฌู ุนุงูุฒ ูุณูุจ ุดุบูู ุงูุญุงูู ุนุดุงู ูุด ูุฑุชุงุญุ ุจุณ ูููุด ุจุฏูู ูุณู.", opts: [{t:"ูุณุชุญูู ูุญุฏ ูุง ููุงูู ุจุฏูู", v:"logic"}, {t:"ููุดู ููุฑุงู ุนุดุงู ุตุญุชู ุงูููุณูุฉ", v:"space"}] },
                { q: "ุฒูุงููู ูู ุงูุดุบู ุจูุฎุฑุฌูุง ูุชูุฑ ููู ุนุงูุฒ ูููุฑ.", opts: [{t:"ูุฎุฑุฌ ูุนุงูู ุนุดุงู ุงูุนูุงูุงุช", v:"hustle"}, {t:"ูุนุชุฐุฑ ุนุดุงู ูููุฑ ูุจูุชู", v:"balance"}] },
                { q: "ุงูุฑุงุฌู ูุณู ููุงุณุจุฉ ูููุฉ ุจุณุจุจ ุถุบุท ุงูุดุบู.", opts: [{t:"ุงูุณุช ุชุนุฐุฑู ูุชูููู ุจุงูุฑุงุญุฉ", v:"support"}, {t:"ุชุฒุนู ูุชุงุฎุฏ ูููู ุนุดุงู ููุชู", v:"space"}] },
                { q: "ุจูููุฑ ูุดุชุบู ุดุบูุงูุฉ ุชุงููุฉ (ุดููุช ูุณุงุฆู) ุจุณ ููุฑุฌุน ููุงู ุจุณ.", opts: [{t:"ูุนูู ูุฏู ุนุดุงู ูุญุณู ุงูุฏุฎู", v:"hustle"}, {t:"ุจูุงุด ุนุดุงู ุตุญุชู ููุฌูุฏู ูู ุงูุจูุช", v:"balance"}] },
                { q: "ุงูุฑุงุฌู ุนุงูุฒ ููุนุฏ ุณุงุนุฉ ููุญุฏู ุฃูู ูุง ูุฑุฌุน ูู ุงูุดุบู ููุตู.", opts: [{t:"ุงูุณุช ุชุฏููู ูุณุงุญุชู ุชูุงูุงู", v:"space"}, {t:"ุชุณุชูุจูู ูุชุญูู ูุนุงู ุนุดุงู ููู", v:"support"}] }
            ],
            personality: [
                { q: "ููุง ุญุฏ ูููุง ูุชุนุตุจ ุฌุฏุงู ูุตูุชู ูุนููุ ุงูุชุงูู ูุนูู ุฅููุ", opts: [{t:"ูุณูุช ุฎุงูุต ูุญุฏ ูุง ุงูุนุงุตูุฉ ุชูุฑ", v:"calm"}, {t:"ูุญุงูู ููุฏูู ููุชูุงูุด ููุชูุง", v:"active"}] },
                { q: "ูู ุงูุฎุฑูุฌุงุชุ ุจูุญุจ ูููู ุงุฌุชูุงุนููู ููุง ููุญุฏูุงุ", opts: [{t:"ุงุฌุชูุงุนููู ููุนุงูุง ูุงุณ", v:"active"}, {t:"ููุญุฏูุง ูู ูุฏูุก", v:"calm"}] },
                { q: "ูู ุญุตู ุณูุก ุชูุงูู ุจุณูุทุ ูุชุตุงูุญ ุฅุฒุงูุ", opts: [{t:"ูุนุชุฐุฑ ุจุงูููุงู ููุฑุงู", v:"active"}, {t:"ูุนูู ูููู ุญูู ููุณููุง ุงูุฒุนู", v:"calm"}] },
                { q: "ููู ูููุง ุจููุชุฑ ุงูุชุงูู ุฃูุชุฑ ูู ุงูููุงูู ุงูุตุนุจุฉุ", opts: [{t:"ุฃูุง (ูุญุชุงุฌ ุฃูุฏู)", v:"active"}, {t:"ุฃูุช (ูุญุชุงุฌ ุชูู)", v:"calm"}] },
                { q: "ุงูุบูุฑุฉ.. ูู ูู ุฏููู ุญุจ ููุง ููุฉ ุซูุฉุ", opts: [{t:"ุฏููู ุญุจ (ุจุญุฏูุฏ)", v:"active"}, {t:"ุจุชุนูู ูุดุงูู ูููุงุด ูุงุฒูุฉ", v:"calm"}] },
                { q: "ูู ูุงุญุฏ ูููุง ุฒุนูุงู ููุฎูููุ ููุถู ุฅููุ", opts: [{t:"ูุชุณุงุจ ููุญุฏู ุดููุฉ", v:"calm"}, {t:"ุงูุชุงูู ููุถู ุฌูุจู ููุถุบุท ุนููู ูุญูู", v:"active"}] },
                { q: "ุงูุตุฑุงุญุฉ ุงููุทููุฉ (ุญุชู ูู ุชุฌุฑุญ) ููุง ุงููุฌุงููุฉ (ุนุดุงู ููุดู ุงูุฏููุง)ุ", opts: [{t:"ุงูุตุฑุงุญุฉ ูููุง ูุงูุช", v:"active"}, {t:"ุงููุฌุงููุฉ ูุชุทููุจ ุงูุฎุงุทุฑ", v:"calm"}] },
                { q: "ููู ูููุง ุจูุนุฑู ูุนุจุฑ ุนู ูุดุงุนุฑู ุฃุญุณูุ", opts: [{t:"ุงูุฑุงุฌู", v:"calm"}, {t:"ุงูุณุช", v:"active"}] },
                { q: "ููุง ูููู ูู ูุดูุงุฑุ ุจูุญุจ ูุฎุทุท ููุง ููุดู ุจุงูุจุฑูุฉุ", opts: [{t:"ุชุฎุทูุท ูููุงุนูุฏ", v:"calm"}, {t:"ุฒู ูุง ุชูุฌู ุชูุฌู", v:"active"}] },
                { q: "ูู ุจูุญุจ ูุดุงุฑู ุชูุงุตูู ููููุง ุนุงูุณูุดูุงู ููุฏูุงุ", opts: [{t:"ุฃูุ ุฐูุฑูุงุช", v:"active"}, {t:"ูุฃุ ุฎุตูุตูุฉ", v:"calm"}] },
                { q: "ูู ุญุฏ ูููุง ุงูุชูุฏ ูุจุณ ุงูุชุงููุ ุฑุฏ ุงููุนู ุจููููุ", opts: [{t:"ูุบูุฑู ููุฑุงู ุนุดุงู ูุฑุถูู", v:"calm"}, {t:"ูุชูุณู ุจุฑุฃูู ูุฐููู", v:"active"}] },
                { q: "ุงููุฏุงูุง.. ูููุชูุง ูู ุณุนุฑูุง ููุง ูู ูุนูุงูุงุ", opts: [{t:"ูููุชูุง ุงููุงุฏูุฉ (ุฐูุจ/ูุถุฉ)", v:"calm"}, {t:"ูููุชูุง ุงููุนูููุฉ (ูุฑุฏ/ุฌูุงุจ)", v:"active"}] },
                { q: "ุจุชุญุจูุง ุงูุฑุณุงูู ุงูุทูููุฉ ููุง ุงูููุงููุงุชุ", opts: [{t:"ุฑุณุงูู (ุนุดุงู ููุฑุงูุง ุชุงูู)", v:"calm"}, {t:"ููุงููุงุช (ุนุดุงู ูุณูุน ุงูุตูุช)", v:"active"}] }
            ],
            wedding: [
                { q: "ุงููุฑุญ.. ูููุฉ ุงูุนูุฑ ููุง ูุตุงุฑูู ุนุงููุงุถูุ", opts: [{t:"ูููุฉ ุงูุนูุฑ (ูุงุฒู ููุฑุญ)", v:"dream"}, {t:"ูููุฑ ูููุณู ูุญุงุฌุฉ ุฃูู", v:"plan"}] },
                { q: "ุดูุฑ ุงูุนุณู.. ูู ูุตุฑ ููุง ุจุฑุฉุ", opts: [{t:"ุจุฑุฉ (ุชุฌุฑุจุฉ ุฌุฏูุฏุฉ)", v:"dream"}, {t:"ุฌูุฉ (ุฃููุฑ ูุฃุณูู)", v:"plan"}] },
                { q: "ูุงุฆูุฉ ุงูุนูุด.. ููุดู ุจุงูุนุฑู ููุง ุจุงูุดุฑุนุ", opts: [{t:"ุงูุนุฑู (ุนุดุงู ุงูุฃูู)", v:"plan"}, {t:"ุงูุดุฑุน (ุงูุชูุณูุฑ)", v:"dream"}] },
                { q: "ุงูุดุจูุฉ.. ุฏูุจ ูุชูุฑ ููุฒููุฉ ููุง ุญุงุฌุงุช ุจุณูุทุฉ ูุดููุ", opts: [{t:"ุฏูุจ ูุชูุฑ (ุฃูุงู)", v:"plan"}, {t:"ุจุณูุทุฉ (ุฐูู)", v:"dream"}] },
                { q: "ุงูุชุตููุฑ.. ูุฌูุจ ูุตูุฑ ูุญุชุฑู ุบุงูู ููุง ุญุฏ ูู ุงูุตุญุงุจ ูุตูุฑุ", opts: [{t:"ูุญุชุฑู (ุงูุตูุฑ ุจุชุนูุด)", v:"dream"}, {t:"ูููุฑ ุงูุจูุฏ ุฏู", v:"plan"}] },
                { q: "ุงูุจูููู.. ุฃูู ูุชูุฑ ููุชููุน ููุง ุญุงุฌุงุช ุจุณูุทุฉุ", opts: [{t:"ูุชูุฑ (ุนุดุงู ุงููุงุณ ูุชุชูููุด)", v:"plan"}, {t:"ุจุณูุท (ุงูููู ุงููุฑุญุฉ)", v:"dream"}] },
                { q: "ุงููุณุชุงู ูุงูุจุฏูุฉ.. ุฅูุฌุงุฑ ููุง ุดุฑุงุกุ", opts: [{t:"ุดุฑุงุก (ุฐูุฑู)", v:"dream"}, {t:"ุฅูุฌุงุฑ (ููู ูููุนุฏู)", v:"plan"}] },
                { q: "ุนุฏุฏ ุงููุนุงุฒูู.. ูู ุงููุนุงุฑู ููุง ุงููุฑูุจูู ุจุณุ", opts: [{t:"ูุฑุญ ูุจูุฑ ูููุฉ", v:"dream"}, {t:"ูุฑุญ ูุงุฏู ููุญูุฏู", v:"plan"}] },
                { q: "ุงูุฏู ุฌู.. ุฃุบุงูู ุดุนุจู ูุฑูุต ููุง ูุงุฏู ูููุงุณููุ", opts: [{t:"ุดุนุจู ูููุตุฉ", v:"dream"}, {t:"ูุงุฏู ูุดูู", v:"plan"}] },
                { q: "ุฒูุฉ ุงูุนุฑุจูุงุช.. ุถุฑูุฑูุฉ ููุง ุฏูุดุฉุ", opts: [{t:"ุถุฑูุฑูุฉ ุฏู ูุฑุญุฉ", v:"dream"}, {t:"ุฏูุดุฉ ููููุงุด ูุฒูุฉ", v:"plan"}] }
            ],
            home: [
                { q: "ุบุณูู ุงูููุงุนูู.. ูููุฉ ูููุ", opts: [{t:"ุงูุณุช (ุฏู ููููุชูุง)", v:"tradition"}, {t:"ูุดุงุฑูุฉ (ุฅูุฏ ุนูู ุฅูุฏ)", v:"modern"}] },
                { q: "ูุตุฑูู ุงูุจูุช.. ูุน ูููุ", opts: [{t:"ูุน ุงูุณุช (ูู ุฃุฏุฑู ุจุงูุทูุจุงุช)", v:"tradition"}, {t:"ูุน ุงูุฑุงุฌู (ูู ุงููู ุจูุฏูุน)", v:"modern"}] },
                { q: "ุงูุฃูู.. ุทุจุฎ ุจูุช ูู ููู ููุง ุฏูููุฑู ูู ุงูููู ุฅูุฏุ", opts: [{t:"ุทุจุฎ ุจูุช (ุตุญุฉ ูุชูููุฑ)", v:"tradition"}, {t:"ุฏูููุฑู ุณุงุนุงุช (ุฑุงุญุฉ)", v:"modern"}] },
                { q: "ุฒูุงุฑุงุช ุงูุฃูู.. ูู ุฃุณุจูุน ููุง ุญุณุจ ุงูุธุฑููุ", opts: [{t:"ููู ููุฏุณ ุฃุณุจูุนูุงู", v:"tradition"}, {t:"ุญุณุจ ุงููุถุงูุฉ", v:"modern"}] },
                { q: "ุงูุฎููุฉ.. ุฃูู ุณูุฉ ููุง ูุฃุฌู ุดููุฉุ", opts: [{t:"ุฃูู ุณูุฉ (ุงูุฑุฒู ุจูุฌู)", v:"tradition"}, {t:"ูุฃุฌู (ูุณุชูุชุน ุจุจุนุถ)", v:"modern"}] },
                { q: "ุงูุชููุฒููู.. ูุงุชุดุงุช ููุฑุฉ ููุง ูุณูุณูุงุชุ", opts: [{t:"ูุงุชุดุงุช (ุญูู ููุตู)", v:"tradition"}, {t:"ูุชูู ุนูู ุญุงุฌุฉ ุณูุง", v:"modern"}] },
                { q: "ุงููุธุงูุฉ.. ููู ูุงุญุฏ ูู ุงูุฃุณุจูุน ููุง ูู ููู ุญุงุฌุฉุ", opts: [{t:"ุญููุฉ ูุธุงูุฉ ููู ุงูุฌูุนุฉ", v:"tradition"}, {t:"ุฃูู ุจุฃูู ุนุดุงู ููุชุนุด", v:"modern"}] },
                { q: "ููุชุงุญ ุงูุจูุช.. ููู ูุจูู ูุนุงู ูุณุฎุฉ ุฒูุงุฏุฉุ", opts: [{t:"ุงูุฃูู (ููุทูุงุฑุฆ)", v:"tradition"}, {t:"ูุญุฏุด (ุฎุตูุตูุฉ)", v:"modern"}] },
                { q: "ูู ูุงุญุฏ ุชุนุจุ ุงูุชุงูู ูุนูู ุฅููุ", opts: [{t:"ูุงุฎุฏ ุฃุฌุงุฒุฉ ูููุนุฏ ุฌูุจู", v:"modern"}, {t:"ูุชุตู ุจุงูุฃูู ูุฌูุง", v:"tradition"}] },
                { q: "ุงูุฎูุงูุงุช.. ุตูุช ุนุงูู ููุง ุฎุตุงูุ", opts: [{t:"ูุฎูุต ุงูููุถูุน ูู ููุชู", v:"modern"}, {t:"ูู ูุงุญุฏ ููุฏู ูู ุฃูุถุฉ", v:"tradition"}] }
            ],
            crisis: [
                { q: "ูู ุญุฏ ูููุง ุณุงุจ ุดุบููุ ูุนูู ุฅููุ", opts: [{t:"ูููู ูุตุงุฑูููุง ููุฑุงู", v:"logic"}, {t:"ุงูุชุงูู ูุดูู ุงูุจูุช ูู ููุฏุฑ", v:"emotion"}] },
                { q: "ูู ุญุตู ุชุฏุฎู ูู ุงูุฃูู ูู ูุดููุฉ ุจููุงุ", opts: [{t:"ูุณูุน ููุงููู ุงุญุชุฑุงูุงู", v:"emotion"}, {t:"ูุฑูุถ ุงูุชุฏุฎู ุจุฃุฏุจ", v:"logic"}] },
                { q: "ูู ุญุณููุง ุจููู ูุฒูู ูู ุงูุนูุงูุฉุ", opts: [{t:"ูุณุงูุฑ ูุบูุฑ ุฌู", v:"emotion"}, {t:"ููุนุฏ ูุชููู ุจุตุฑุงุญุฉ", v:"logic"}] },
                { q: "ูู ูุงุญุฏ ุบูุท ุบูุทุฉ ูุจูุฑุฉุ", opts: [{t:"ูุณุงูุญ ุนุดุงู ุงูุญุจ", v:"emotion"}, {t:"ูุชุนุงุชุจ ููุงุฎุฏ ูููู", v:"logic"}] },
                { q: "ูู ุงููููุณ ูุตุฑุช ูู ูุต ุงูุดูุฑุ", opts: [{t:"ูุณุชูู ูู ุงูุฃูู", v:"emotion"}, {t:"ูุงูู ุฃู ุญุงุฌุฉ ูููุดููุง", v:"logic"}] },
                { q: "ูู ุญุฏ ูููุง ุฌุงูู ุงูุชุฆุงุจุ", opts: [{t:"ูุฑูุญ ูุฏูุชูุฑ ููุฑุงู", v:"logic"}, {t:"ูุญุชููู ููุทุจุทุจ ุนููู", v:"emotion"}] }
            ]
        };

        const conclusions = {
            active: "ุฃูุชูุง ูุงุจูุฒ ุญููู ุฌุฏุงูุ ุจุชุญุจูุง ุงูุญุฑูุฉ ูุงูููุงู ูุงูููุงุฌูุฉ.",
            calm: "ุฃูุชูุง ูุงุจูุฒ ูุงุฏู ูุนุงููุ ุจุชุญุจูุง ุงูุฑููุงู ูุชูุจุฑูุง ุฏูุงุบูู.",
            dream: "ุฃูุชูุง ุฑููุงูุณููู ูุฎูุงููู ูุงุณุนุ ุจุชูุชููุง ุจุงููุดุงุนุฑ ูุงูุฐูุฑูุงุช.",
            plan: "ุฃูุชูุง ูุงูุนููู ูุนูููููุ ุจุชูุชููุง ุจุงูุฃูุงู ูุงูุงุณุชูุฑุงุฑ ุงููุงุฏู.",
            modern: "ุชูููุฑูู ูุฑู ูุญุฏูุซุ ุจุชุคูููุง ุจุงููุดุงุฑูุฉ ูุงููุณุงูุงุฉ.",
            tradition: "ุจุชุญุชุฑููุง ุงูุฃุตูู ูุงูุนุงุฏุงุชุ ูุจุชุญุจูุง ุงูุงุณุชูุฑุงุฑ ุงูุฃุณุฑู.",
            emotion: "ููุจูู ูู ุงููู ุจูุญุฑูููุ ุงูุนุงุทูุฉ ุนูุฏูู ุฃูู ูู ุงูุญุณุงุจุงุช.",
            logic: "ุงูุนูู ูู ุงููู ุณุงููุ ุจุชุญุจูุง ุชุญููุง ุงููุดุงูู ุจููุทู.",
            // Work Stress Specific
            hustle: "ุงูุฑุงุฌู ุดุงูู ุญูู ูุจูุฑ ูุนุงูุฒ ูุซุจุช ููุณู. ูุญุชุงุฌ ุชุดุฌูุน.",
            balance: "ุฃูุชูุง ููุฏุฑูู ูููุฉ 'ุงูุจูุช' ู 'ุงูุนููุฉ' ููู ุฃู ูููุณ.",
            support: "ุงูุณุช ูู ุงูุณูุฏ ุงูุญููููุ ูุงูุจูุช ุฏู ูุงูู ุนูู ุงูุงุญุชูุงุก.",
            space: "ุจุชุญุชุฑููุง ุงูุฎุตูุตูุฉ ูุงููุณุงุญุฉ ุงูุดุฎุตูุฉ. ุนูุงูุฉ ูุงุถุฌุฉ."
        };

        // SAFE, CONSERVATIVE, BONDING TASKS (Promises/Vows)
        const judgementBank = [
            "ูุนุฏ: ูุฑุงุกุฉ ุณูุฑุฉ ุงูููู ุณููุงู ุจููุฉ ุงูุจุฑูุฉ.",
            "ูุนุฏ: ุนุฏู ุงูููู ููุญู ูุชุฎุงุตูุงู ุฃุจุฏุงู.",
            "ูุนุฏ: ูููุฉ 'ุดูุฑุงู' ู 'ุชุณูู ุฅูุฏู' ุชููู ุฃุณุงุณูุฉ ูู ููู.",
            "ูููุฉ: ูุชุงุจุฉ ุฑุณุงูุฉ ูุฑููุฉ ูููุง 3 ุตูุงุช ุชุญุจูุง ูู ุงูุขุฎุฑ.",
            "ูุนุฏ: ุงูุฏุนุงุก ููุดุฑูู ูู ูู ุตูุงุฉ ููุฏุฉ ุฃุณุจูุน.",
            "ูููุฉ: ุงูุงุชูุงู ุนูู 'ูููุฉ ุณุฑ' ูููููุง ููุง ูููู ูุญุชุงุฌูู ุญุถู/ุฏุนู.",
            "ูุนุฏ: ุญูุธ ุณุฑ ุงูุจูุช ูุนุฏู ุฎุฑูุฌู ูุฃู ูุฎููู.",
            "ูููุฉ: ุงูุชุตุฏู ุจูุจูุบ ุจุณูุท ุณููุงู ุจููุฉ ุงูุชูููู.",
            "ูุนุฏ: ุชุฎุตูุต ุณุงุนุฉ ุฃุณุจูุนูุงู ููููุงู ูู ุงูููุจ ุจุฏูู ููุจุงููุงุช.",
            "ูููุฉ: ูู ุทุฑู ููุชุจ ูุงุฆูุฉ ุจุงูุญุงุฌุงุช ุงููู ุจุชุฒุนูู ูุงูุชุงูู ููุฑุงูุง.",
            "ูุนุฏ: ุงุญุชุฑุงู ุงูุฃูู ูุนุฏู ุฐูุฑูู ุจุณูุก ุฃุจุฏุงู.",
            "ูููุฉ: ุงุฎุชูุงุฑ ุงุณู ุฏูุน ุฌุฏูุฏ ูุจุนุถ.",
            "ูุนุฏ: ุงููุณุงูุญุฉ ูู ุฃุฎุทุงุก ุงููุงุถู ููุชุญ ุตูุญุฉ ุฌุฏูุฏุฉ.",
            "ูููุฉ: ุงูุชุฎุทูุท ูุฃูู ุนูุฑุฉ ุณููุงู ุจุนุฏ ุงูุฒูุงุฌ ุฅู ุดุงุก ุงููู.",
            "ูุนุฏ: ุงูุฑุงุฌู ููุนุฏ ุฅูู ููุฎุฑุฌุด ูุดุงูู ุงูุดุบู ูู ุงูุจูุช.",
            "ูุนุฏ: ุงูุณุช ุชูุนุฏ ุฅููุง ุชููู ูุตุฏุฑ ูุฏูุก ูุณูู ููุช ุงูุฃุฒูุงุช."
        ];

        // --- STATE ---
        let state = { deck: [], idx: 0, scores: {} };

        // --- FUNCTIONS ---
        function showScreen(id) {
            $('.screen').removeClass('active');
            $(`#${id}`).addClass('active');
        }

        function startGame(mode) {
            // Shuffle and pick 15 questions max to keep it dynamic but long enough
            let pool = [...db[mode]];
            // Duplicate array items if less than 15 to make longer play? 
            // Or just shuffle. Since some categories have <15, we take all of them.
            pool.sort(() => 0.5 - Math.random());
            state.deck = pool; // Use all available questions
            
            state.idx = 0;
            state.scores = {};
            showScreen('screen-game');
            renderCard();
        }

        function renderCard() {
            if(state.idx >= state.deck.length) {
                showConclusion();
                return;
            }
            
            const item = state.deck[state.idx];
            const content = $('#card-content');
            $('#game-card').removeClass('animate__zoomIn');
            void document.getElementById('game-card').offsetWidth;
            $('#game-card').addClass('animate__zoomIn');

            $('#counter').text(`${state.idx + 1}/${state.deck.length}`);
            $('#progress-bar').css('width', ((state.idx) / state.deck.length * 100) + '%');

            content.html(`
                <div class="ar-font fw-bold mb-4" style="font-size:1.3rem; line-height:1.6;">${item.q}</div>
                <div class="d-flex flex-column gap-custom w-100">
                    <div class="choice-btn ar-font" onclick="vote('${item.opts[0].v}')">${item.opts[0].t}</div>
                    <div class="choice-btn ar-font" onclick="vote('${item.opts[1].v}')">${item.opts[1].t}</div>
                </div>
            `);
        }

        function vote(val) {
            state.scores[val] = (state.scores[val] || 0) + 1;
            state.idx++;
            renderCard();
        }

        function showConclusion() {
            // Find max score
            const winner = Object.keys(state.scores).reduce((a, b) => state.scores[a] > state.scores[b] ? a : b);
            $('#conclusion-text').text(conclusions[winner] || "ุฃูุชูุง ูุงุจูุฒ ูุชูุงุฒู ุฌุฏุงู.");
            showScreen('screen-conclusion');
        }

        function showWhoJudges() {
            showScreen('screen-who-judges');
        }

        function pickJudgements(who) {
            // Shuffle and pick 3
            const shuffled = judgementBank.sort(() => 0.5 - Math.random());
            const selected = shuffled.slice(0, 3);
            
            const list = $('#judgement-list');
            list.html('');
            
            selected.forEach(j => {
                list.append(`<div class="judge-option ar-font fw-bold" onclick="finalize('${j}')">${j}</div>`);
            });

            showScreen('screen-pick');
        }

        function finalize(text) {
            $('#final-verdict-text').text(text);
            showScreen('screen-final');
        }

        // --- SNOW ANIMATION ---
        const canvas = document.getElementById('snow-canvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        const particles = [];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        
        function initSnow() {
            resize();
            for(let i=0; i<60; i++) {
                particles.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    r: Math.random() * 2 + 1,
                    d: Math.random() * 1 + 0.5
                });
            }
            loop();
        }

        function loop() {
            ctx.clearRect(0,0,width,height);
            ctx.fillStyle = "rgba(255, 255, 255, 0.7)";
            ctx.beginPath();
            for(let i=0; i<particles.length; i++) {
                const p = particles[i];
                ctx.moveTo(p.x, p.y);
                ctx.arc(p.x, p.y, p.r, 0, Math.PI*2, true);
                p.y += p.d;
                if(p.y > height) p.y = -5;
            }
            ctx.fill();
            requestAnimationFrame(loop);
        }

        window.addEventListener('resize', resize);
        initSnow();

    </script>
</body>
</html>