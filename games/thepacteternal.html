<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Pact: Eternal</title>
    
    <!-- Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Cinzel:wght@500;900&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #050505;
            --text-color: #E0E0E0;
            --accent: #A71D31; /* Deep Cinematic Red */
            --choice-bg: rgba(255, 255, 255, 0.08);
            --choice-hover: rgba(167, 29, 49, 0.3);
            --overlay: rgba(0, 0, 0, 0.85);
        }

        /* --- GLOBAL --- */
        html, body {
            height: 100%; width: 100%; margin: 0; padding: 0;
            overflow: hidden; 
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Montserrat', sans-serif;
            user-select: none; -webkit-tap-highlight-color: transparent;
        }

        .ar-font { font-family: 'Cairo', sans-serif; direction: rtl; }
        .cinematic-font { font-family: 'Cinzel', serif; letter-spacing: 2px; text-transform: uppercase; }

        /* --- BACKGROUND ANIMATION --- */
        #fx-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none; overflow: hidden;
        }

        .floater {
            position: absolute; opacity: 0; bottom: -50px;
            animation: floatUp linear forwards;
        }
        .floater.heart { 
            color: var(--accent); font-size: 1.5rem; 
            text-shadow: 0 0 10px rgba(167, 29, 49, 0.5);
        }
        .floater.card {
            width: 30px; height: 45px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg) scale(0.8); opacity: 0; }
            15% { opacity: 0.6; }
            85% { opacity: 0.6; }
            100% { transform: translateY(-110vh) rotate(360deg) scale(1.2); opacity: 0; }
        }

        /* --- SCREENS (Full Height, No Letterbox) --- */
        .screen { 
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            flex-direction: column; padding: 40px 20px; z-index: 10; box-sizing: border-box;
            align-items: center;
        }
        /* Center content vertically by default */
        .screen-center { justify-content: center; }
        .screen.active { display: flex !important; animation: fadeIn 0.8s; }

        /* --- UI ELEMENTS --- */
        
        .btn-cinematic {
            background: transparent; color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 15px 40px; font-size: 1.2rem;
            text-transform: uppercase; letter-spacing: 3px;
            cursor: pointer; transition: 0.3s;
            margin-top: 20px; position: relative; overflow: hidden;
        }
        .btn-cinematic:hover {
            background: white; color: black; border-color: white;
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
        }

        /* --- SCROLLING CONTAINERS --- */
        /* Used for Episodes and Vows to ensure they fit */
        .scroll-wrapper {
            width: 100%; max-width: 600px;
            flex-grow: 1; /* Takes all available vertical space */
            overflow-y: auto; /* Scrolls if content is too long */
            margin: 20px 0;
            padding-right: 5px; /* Space for scrollbar */
            
            /* Hide Scrollbar for cleaner look */
            scrollbar-width: none; 
            -ms-overflow-style: none;
        }
        .scroll-wrapper::-webkit-scrollbar { display: none; }
        
        /* Episode Cards */
        .episode-card {
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.05) 50%, transparent 100%);
            border-top: 1px solid rgba(255,255,255,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding: 25px 0; margin-bottom: 10px;
            cursor: pointer; text-align: center; transition: 0.3s;
        }
        .episode-card:hover { background: rgba(255,255,255,0.1); }
        .episode-card:active { border-color: var(--accent); }

        /* Story Interface */
        .narrative-text {
            font-size: 1.5rem; line-height: 1.6; text-align: center;
            color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            margin-bottom: 40px; max-width: 700px;
        }

        .choice-container {
            width: 100%; max-width: 600px;
            display: flex; flex-direction: column; gap: 15px;
        }

        .choice-btn {
            background: var(--choice-bg);
            border: 1px solid rgba(255,255,255,0.1);
            color: #ddd; padding: 20px;
            text-align: center; font-size: 1.1rem;
            cursor: pointer; transition: 0.2s;
            position: relative;
        }
        .choice-btn:active {
            background: var(--choice-hover);
            border-color: var(--accent);
            color: white; transform: scale(0.98);
        }

        /* Notification Toast */
        .toast-notification {
            position: fixed; top: 20px; left: 20px;
            font-family: 'Montserrat', sans-serif; font-size: 0.7rem;
            color: #aaa; text-transform: uppercase; letter-spacing: 1px;
            opacity: 0; pointer-events: none; transition: opacity 0.5s; z-index: 100;
        }
        .toast-notification.show { opacity: 1; }

        /* Vow Cards */
        .vow-card {
            border: 1px solid rgba(255,255,255,0.15);
            padding: 25px; margin-bottom: 15px;
            background: rgba(0,0,0,0.3);
            font-size: 1.2rem; cursor: pointer;
            transition: 0.2s; border-radius: 8px;
            text-align: center;
        }
        .vow-card:active { 
            border-color: var(--accent); 
            background: rgba(167, 29, 49, 0.2); 
            transform: scale(0.98);
        }

    </style>
</head>
<body>

    <!-- BACKGROUND FX -->
    <div id="fx-container"></div>
    
    <!-- NOTIFICATION -->
    <div id="toast" class="toast-notification">? The story remembers...</div>

    <!-- 1. LANDING SCREEN -->
    <div id="screen-landing" class="screen screen-center active">
        <div style="opacity: 0.7; font-size: 0.9rem; letter-spacing: 4px; margin-bottom: 10px;">INTERACTIVE SERIES</div>
        <h1 class="cinematic-font animate__animated animate__fadeIn" style="font-size: 3.5rem; margin-bottom: 10px;">THE PACT</h1>
        <div class="ar-font" style="font-size: 1.2rem; color: #888; margin-bottom: 40px;">Ø§Ù„Ù€Ù€Ø¹Ù€Ù€Ù‡Ù€Ù€Ø¯ : Ø§Ù„Ø£Ø¨Ù€Ù€Ø¯ÙŠ</div>
        
        <button class="btn-cinematic animate__animated animate__fadeInUp" onclick="showScreen('screen-episodes')">
            Start Episode
        </button>
    </div>

    <!-- 2. EPISODE SELECTOR -->
    <div id="screen-episodes" class="screen">
        <h2 class="cinematic-font mb-4" style="color: #888;">Select Scenario</h2>
        
        <div class="scroll-wrapper">
            <!-- Ep 1 -->
            <div class="episode-card" onclick="startEpisode('friday')">
                <div class="cinematic-font fs-4 mb-1">Episode 1: The Morning</div>
                <div class="ar-font text-white-50">Ø®Ù†Ø§Ù‚Ø© ÙŠÙˆÙ… Ø§Ù„Ø¬Ù…Ø¹Ø©: Ø§Ù„Ù†ÙˆÙ… ÙˆÙ„Ø§ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ</div>
            </div>
            <!-- Ep 2 -->
            <div class="episode-card" onclick="startEpisode('shopping')">
                <div class="cinematic-font fs-4 mb-1">Episode 2: The Market</div>
                <div class="ar-font text-white-50">ØµØ¯Ù…Ø© Ø§Ù„ÙƒØ§Ø´ÙŠØ± ÙˆÙ…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¨ÙŠØª</div>
            </div>
            <!-- Ep 3 -->
            <div class="episode-card" onclick="startEpisode('inlaws')">
                <div class="cinematic-font fs-4 mb-1">Episode 3: The Guest</div>
                <div class="ar-font text-white-50">Ù…ÙƒØ§Ù„Ù…Ø© Ù…ÙØ§Ø¬Ø£Ø©: Ø­Ù…Ø§ØªÙƒ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø§Ø¨</div>
            </div>
            <!-- Ep 4 -->
            <div class="episode-card" onclick="startEpisode('anger')">
                <div class="cinematic-font fs-4 mb-1">Episode 4: The Accident</div>
                <div class="ar-font text-white-50">Ø§Ù„Ø·ÙÙ„ ÙƒØ³Ø± Ø§Ù„ÙØ§Ø²Ø©: Ø¹ØµØ¨ÙŠØ© ÙˆÙ„Ø§ Ø§Ø­ØªÙˆØ§Ø¡ØŸ</div>
            </div>
            <!-- Ep 5 -->
            <div class="episode-card" onclick="startEpisode('jealousy')">
                <div class="cinematic-font fs-4 mb-1">Episode 5: The Notification</div>
                <div class="ar-font text-white-50">Ø±Ø³Ø§Ù„Ø© Ù†Øµ Ø§Ù„Ù„ÙŠÙ„ ÙˆØ§Ù„Ø´Ùƒ</div>
            </div>
        </div>
        
        <div style="margin-top: 10px; cursor: pointer; color: #555; padding: 10px;" onclick="showScreen('screen-landing')">BACK</div>
    </div>

    <!-- 3. GAMEPLAY -->
    <div id="screen-game" class="screen screen-center">
        
        <!-- Story Text -->
        <div id="narrative-box" class="narrative-text ar-font animate__animated">
            <!-- Text injected here -->
        </div>

        <!-- Choices -->
        <div id="choices-box" class="choice-container">
            <!-- Buttons injected here -->
        </div>

    </div>

    <!-- 4. DIAGNOSIS -->
    <div id="screen-diagnosis" class="screen screen-center">
        <div style="font-size: 0.9rem; letter-spacing: 2px; color: #666; margin-bottom: 20px;">ARCHETYPE UNLOCKED</div>
        
        <div id="diag-icon" style="font-size: 4rem; margin-bottom: 20px; opacity: 0.8;"></div>
        <h2 id="diag-title" class="cinematic-font animate__animated animate__fadeIn" style="font-size: 2rem; color: var(--accent); text-align: center;"></h2>
        
        <p id="diag-desc" class="ar-font fs-4 text-center" style="max-width: 600px; color: #ccc; margin-top: 20px;">
            ...
        </p>

        <button class="btn-cinematic mt-5" onclick="showWhoJudges()">
            Enter Judgement
        </button>
    </div>

    <!-- 5. ROULETTE -->
    <div id="screen-who-judges" class="screen screen-center">
        <h2 class="cinematic-font mb-5" style="color: #888;">Fate Decides</h2>
        
        <div id="winner-name" class="fw-bold animate__animated" style="font-size: 3rem; color: white; letter-spacing: 5px; margin-bottom: 40px;">
            ???
        </div>

        <button id="roulette-btn" class="btn-cinematic" onclick="spinRoulette()">
            Spin
        </button>
    </div>

    <!-- 6. PACT SELECTION -->
    <div id="screen-pick" class="screen">
        <h3 class="cinematic-font mb-2" style="color: var(--accent);">Seal The Pact</h3>
        <p class="text-white-50 mb-4 text-center" style="font-size: 0.9rem;">Choose the vow your partner must keep.</p>

        <!-- Scrollable Vow List -->
        <div id="judgement-list" class="scroll-wrapper">
            <!-- Vows injected here -->
        </div>
    </div>

    <!-- 7. FINAL SCENE -->
    <div id="screen-final" class="screen screen-center">
        <div class="animate__animated animate__fadeIn" style="font-size: 5rem; margin-bottom: 20px; color: var(--accent);">ğŸ“œ</div>
        <h1 class="cinematic-font mb-4">It Is Written</h1>
        
        <div id="final-verdict-text" class="ar-font fs-3 text-center p-4" style="border-top: 1px solid #333; border-bottom: 1px solid #333; color: #eee; max-width: 600px;">
            ...
        </div>

        <button class="btn-cinematic mt-5" onclick="showScreen('screen-episodes')">Return</button>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // --- ANIMATION SYSTEM ---
        function spawnParticle() {
            const el = document.createElement('div');
            const type = Math.random() > 0.6 ? 'card' : 'heart';
            el.className = `floater ${type}`;
            if(type === 'heart') el.innerHTML = 'â™¥';
            
            el.style.left = Math.random() * 95 + '%';
            const scale = Math.random() * 0.5 + 0.8;
            el.style.transform = `scale(${scale})`;
            el.style.animationDuration = (Math.random() * 4 + 6) + 's';
            
            document.getElementById('fx-container').appendChild(el);
            setTimeout(() => el.remove(), 10000);
        }

        // Background Loop
        setInterval(spawnParticle, 1200);

        // --- CONTENT DATABASE ---
        const episodes = {
            friday: {
                questions: [
                    { t: "Ø§Ù„Ø³Ø§Ø¹Ø© 11 Ø§Ù„Ø¸Ù‡Ø±. Ù‡Ùˆ ØªØ¹Ø¨Ø§Ù† Ù…Ù† Ø§Ù„Ø´ØºÙ„ØŒ ÙˆÙ‡ÙŠ Ø²Ù‡Ù‚Ø§Ù†Ø© Ù…Ù† Ù‚Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØª. Ø§Ù„Ù‚Ø±Ø§Ø±ØŸ", 
                      opts: [{txt:"Ù†ÙƒÙ…Ù„ Ù†ÙˆÙ… ÙˆÙ†Ù‚Ø¶ÙŠ Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø¨ÙŠØª (Ø±Ø§Ø­Ø©)", type:"home"}, {txt:"Ù†ÙŠØ¬ÙŠ Ø¹Ù„Ù‰ Ù†ÙØ³Ù†Ø§ ÙˆÙ†Ø®Ø±Ø¬ (Ø£ÙƒØ´Ù†)", type:"out"}] },
                    { t: "Ù„Ùˆ Ù‚Ø¹Ø¯Ù†Ø§ ÙÙŠ Ø§Ù„Ø¨ÙŠØªØŒ Ø§Ù„Ù…ÙˆØ¯ Ù‡ÙŠÙƒÙˆÙ† Ø¥ÙŠÙ‡ØŸ", 
                      opts: [{txt:"ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙŠÙ…Ø³Ùƒ Ù…ÙˆØ¨Ø§ÙŠÙ„Ù‡ ÙˆÙŠÙØµÙ„", type:"separate"}, {txt:"Ù†Ø¹Ù…Ù„ ÙØ´Ø§Ø± ÙˆÙ†ØªÙØ±Ø¬ Ø¹Ù„Ù‰ ÙÙŠÙ„Ù… Ø³ÙˆØ§", type:"together"}] },
                    { t: "Ù„Ùˆ Ù†Ø²Ù„Ù†Ø§ØŒ ÙˆØ²Ø­Ù…Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚ Ù‚ÙÙ„ØªÙ†Ø§.. Ù‡Ù†ØªØµØ±Ù Ø¥Ø²Ø§ÙŠØŸ", 
                      opts: [{txt:"Ù†ØªÙ†Ø±ÙØ² ÙˆÙ†Ù‚Ù„Ø¨ ÙˆØ´Ù†Ø§", type:"angry"}, {txt:"Ù†Ø´ØºÙ„ Ø£ØºØ§Ù†ÙŠ ÙˆÙ†Ø§Ø®Ø¯ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ø¨Ø¶Ø­Ùƒ", type:"fun"}] },
                    { t: "Ø¢Ø®Ø± Ø§Ù„ÙŠÙˆÙ….. Ù†ØªØ¹Ø´Ù‰ Ø¥ÙŠÙ‡ØŸ", 
                      opts: [{txt:"Ø¯Ù„ÙŠÙØ±ÙŠ.. ØµØ­ØªÙ†Ø§ Ø£Ù‡Ù… Ù…Ù† Ø§Ù„ÙÙ„ÙˆØ³", type:"easy"}, {txt:"Ø®ÙØ§ÙÙŠ ÙÙŠ Ø§Ù„Ø¨ÙŠØª.. Ù†ÙˆÙØ± Ø§Ù„Ù‚Ø±Ø´ÙŠÙ†", type:"saving"}] }
                ],
                results: {
                    default: { title:"The Balanced Duo", icon:"âš–ï¸", desc:"Ø¨ØªØ­Ø§ÙˆÙ„ÙˆØ§ ØªÙ„Ø§Ù‚ÙˆØ§ Ø­Ù„ÙˆÙ„ ÙˆØ³Ø·ØŒ ÙˆØ¯Ù‡ Ø³Ø± Ø§Ù„Ù†Ø¬Ø§Ø­." },
                    home_separate: { title:"Roommates", icon:"ğŸ ", desc:"Ø¹Ø§ÙŠØ´ÙŠÙ† Ø³ÙˆØ§ Ø¨Ø³ ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙÙŠ Ø¹Ø§Ù„Ù…Ù‡ Ø§Ù„Ø®Ø§Øµ." },
                    out_fun: { title:"Adventure Squad", icon:"ğŸ¢", desc:"Ø¨ØªØ­Ø¨ÙˆØ§ Ø§Ù„Ø­ÙŠØ§Ø© ÙˆØ·Ø§Ù‚ØªÙƒÙ… Ø­Ù„ÙˆØ© Ù…Ø¹ Ø¨Ø¹Ø¶." }
                }
            },
            shopping: {
                questions: [
                    { t: "Ø§Ù„ÙƒØ§Ø´ÙŠØ±: 'Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ù‰ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø¨Ù€ 1000 Ø¬Ù†ÙŠÙ‡'. Ø§Ù„ØªØµØ±ÙØŸ", 
                      opts: [{txt:"Ù†Ø±Ø¬Ø¹ Ø§Ù„Ø­Ø§Ø¬Ø§Øª Ø§Ù„Ø²ÙŠØ§Ø¯Ø© (Ø§Ù„Ø¹Ù‚Ù„)", type:"logic"}, {txt:"Ù†Ø¯ÙØ¹ Ø¨Ø§Ù„ÙÙŠØ²Ø§ ÙˆÙ†Ø®Ø±Ø¨Ù‡Ø§ (Ø§Ù„ØªÙ‡ÙˆØ±)", type:"yolo"}] },
                    { t: "Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§ØªØŸ", 
                      opts: [{txt:"Ø§Ù„Ø³Øª Ø¨Ø³ (Ù‡ÙŠ Ø£Ø¯Ø±Ù‰)", type:"trust"}, {txt:"Ù„Ø§Ø²Ù… Ù†Ø±Ø§Ø¬Ø¹ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø³ÙˆØ§", type:"control"}] },
                    { t: "Ù„Ù‚ÙŠÙ†Ø§ Ø¹Ø±Ø¶ Ù…ØºØ±ÙŠ Ø¹Ù„Ù‰ Ø­Ø§Ø¬Ø© Ù…Ø´ Ù…Ø­ØªØ§Ø¬ÙŠÙ†Ù‡Ø§..", 
                      opts: [{txt:"Ù†Ø´ØªØ±ÙŠÙ‡Ø§ ÙÙˆØ±Ø§Ù‹ØŒ ÙØ±ØµØ©", type:"yolo"}, {txt:"Ù„Ø£ØŒ Ù…Ø´ ÙÙŠ Ø§Ù„Ù„ÙŠØ³ØªØ©", type:"logic"}] },
                    { t: "Ø¥Ø¯Ø§Ø±Ø© Ù…ØµØ±ÙˆÙ Ø§Ù„Ø¨ÙŠØª..", 
                      opts: [{txt:"ÙƒÙ„ ÙˆØ§Ø­Ø¯ Ø°Ù…ØªÙ‡ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù…Ø³ØªÙ‚Ù„Ø©", type:"separate"}, {txt:"Ù…Ø­ÙØ¸Ø© ÙˆØ§Ø­Ø¯Ø© Ù…Ø´ØªØ±ÙƒØ©", type:"shared"}] }
                ],
                results: {
                    default: { title:"Financial Partners", icon:"ğŸ’°", desc:"Ø¹Ù†Ø¯ÙƒÙ… ÙˆØ¹ÙŠ Ù…Ø§Ù„ÙŠ ÙˆØ¨ØªØ­Ø§ÙˆÙ„ÙˆØ§ ØªØ¸Ø¨Ø·ÙˆØ§ Ø§Ù„Ø¯Ù†ÙŠØ§." },
                    logic_control: { title:"Strict Managers", icon:"ğŸ“Š", desc:"Ø§Ù„Ø­ÙŠØ§Ø© 1+1=2. Ø£Ù…Ø§Ù† Ø¨Ø³ Ù…Ø­ØªØ§Ø¬ Ù…Ø±ÙˆÙ†Ø©." },
                    yolo: { title:"The Spenders", icon:"ğŸ’¸", desc:"Ø¨ØªØ´ØªØ±ÙˆØ§ Ø±Ø§Ø­ØªÙƒÙ… ÙˆØ³Ø¹Ø§Ø¯ØªÙƒÙ… Ø¨Ø§Ù„ÙÙ„ÙˆØ³." }
                }
            },
            inlaws: {
                questions: [
                    { t: "Ù…ÙƒØ§Ù„Ù…Ø©: 'Ù…Ø§Ù…Ø§ Ø¬Ø§ÙŠØ© ØªØ²ÙˆØ±ÙƒÙ… ÙƒÙ…Ø§Ù† Ù†Øµ Ø³Ø§Ø¹Ø©'. Ø§Ù„Ø¨ÙŠØª Ù…ÙƒØ±ÙƒØ¨!", 
                      opts: [{txt:"Ø·ÙˆØ§Ø±Ø¦! Ù†Ø¬Ø±ÙŠ Ù†Ø±ÙˆÙ‚ Ø¨Ø³Ø±Ø¹Ø©", type:"stress"}, {txt:"Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙŠÙ‡Ø§ØŒ Ø§Ù„Ø¨ÙŠØª Ø¨ÙŠØªÙ‡Ù…", type:"chill"}] },
                    { t: "Ù„Ùˆ Ø­Ø¯ Ù…Ù† Ø§Ù„Ø£Ù‡Ù„ Ø±Ù…Ù‰ ÙƒÙ„Ù…Ø© Ø¶Ø§ÙŠÙ‚ØªÙƒÙ…..", 
                      opts: [{txt:"Ù†Ø±Ø¯ ÙˆÙ†ÙˆØ¶Ø­ Ø§Ù„Ø­Ø¯ÙˆØ¯ ÙÙˆØ±Ø§Ù‹", type:"defend"}, {txt:"Ù†Ø¹Ø¯ÙŠÙ‡Ø§ ÙˆÙ†ØºÙŠØ± Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹", type:"peace"}] },
                    { t: "Ù†Ø¸Ø§Ù… Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø¹Ù†Ø¯ÙƒÙ…..", 
                      opts: [{txt:"Ø¨Ù…ÙˆØ§Ø¹ÙŠØ¯ ÙˆØªØ±ØªÙŠØ¨ Ù…Ø³Ø¨Ù‚", type:"rules"}, {txt:"Ø§Ù„Ø¨Ø§Ø¨ Ù…ÙØªÙˆØ­ Ø£ÙŠ ÙˆÙ‚Øª", type:"open"}] },
                    { t: "Ø¨Ø¹Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø©..", 
                      opts: [{txt:"ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„ÙƒÙ„ ÙƒÙ„Ù…Ø© Ø§ØªÙ‚Ø§Ù„Øª", type:"analyze"}, {txt:"Ù†ÙØµÙ„ ÙˆÙ†Ù†Ø§Ù…", type:"relax"}] }
                ],
                results: {
                    default: { title:"Family Keepers", icon:"ğŸ›¡ï¸", desc:"Ø¨ØªØ­ØªØ±Ù…ÙˆØ§ Ø§Ù„Ø£Ù‡Ù„ Ø¨Ø³ Ø¨ØªØ­Ù…ÙˆØ§ Ø®ØµÙˆØµÙŠØªÙƒÙ…." },
                    stress_defend: { title:"Defensive Team", icon:"âš”ï¸", desc:"Ø¨ØªØ­Ø³ÙˆØ§ Ø¥Ù†ÙƒÙ… ÙÙŠ Ø­Ø±Ø¨ Ø¯ÙØ§Ø¹ÙŠØ© Ø¯Ø§ÙŠÙ…Ø§Ù‹." },
                    chill_open: { title:"Open Hearts", icon:"â¤ï¸", desc:"Ø¨ÙŠØªÙƒÙ… Ù…ÙØªÙˆØ­ ÙˆÙ‚Ù„Ø¨ÙƒÙ… ÙƒØ¨ÙŠØ±." }
                }
            },
            anger: {
                questions: [
                    { t: "Ø§Ù„Ø·ÙÙ„ ÙƒØ³Ø± Ø§Ù„ÙØ§Ø²Ø© Ø§Ù„ØºØ§Ù„ÙŠØ© ÙˆÙ‡Ùˆ Ø¨ÙŠÙ„Ø¹Ø¨.", 
                      opts: [{txt:"Ø²Ø¹ÙŠÙ‚ ÙˆØ¹Ù‚Ø§Ø¨ ÙÙˆØ±ÙŠ!", type:"strict"}, {txt:"Ù†Ø³Ø£Ù„Ù‡ Ø­ØµÙ„ Ø¥ÙŠÙ‡ ÙˆÙ†ÙÙ‡Ù…Ù‡", type:"calm"}] },
                    { t: "Ù„Ùˆ Ø´Ø±ÙŠÙƒÙƒ Ø§ØªØ¹ØµØ¨ Ø¬Ø¯Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ„Ø¯..", 
                      opts: [{txt:"Ø£ØªØ¯Ø®Ù„ ÙˆØ£Ø¯Ø§ÙØ¹ Ø¹Ù†Ù‡ ÙÙˆØ±Ø§Ù‹", type:"protect"}, {txt:"Ø£Ø³ÙƒØª Ø¹Ø´Ø§Ù† Ù…ÙƒØ³Ø±Ø´ ÙƒÙ„Ù…ØªÙ‡", type:"support"}] },
                    { t: "Ø§Ù„Ø²Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù„ÙˆÙŠØ§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø£ÙƒÙ„..", 
                      opts: [{txt:"Ø®Ø¯ ÙˆØ§Ø³ÙƒØª", type:"easy"}, {txt:"Ù„Ø£ ÙŠØ¹Ù†ÙŠ Ù„Ø£", type:"firm"}] },
                    { t: "Ø¨Ø¹Ø¯ Ù…Ø§ Ø§Ù„Ø¹ÙŠØ§Ù„ ÙŠÙ†Ø§Ù…ÙˆØ§..", 
                      opts: [{txt:"Ø¥ØºÙ…Ø§Ø¡ Ù…Ù† Ø§Ù„ØªØ¹Ø¨", type:"tired"}, {txt:"Ù†Øµ Ø³Ø§Ø¹Ø© Ø±ÙˆÙ‚Ø§Ù† Ø³ÙˆØ§", type:"couple"}] }
                ],
                results: {
                    default: { title:"Wise Parents", icon:"ğŸ¦‰", desc:"Ø§Ù„ØªØ±Ø¨ÙŠØ© ØµØ¹Ø¨Ø©ØŒ Ø¨Ø³ Ø§Ù†ØªÙˆØ§ Ø¨ØªØ­Ø§ÙˆÙ„ÙˆØ§." },
                    strict_firm: { title:"Commanders", icon:"ğŸ‘®", desc:"Ø§Ù„Ù†Ø¸Ø§Ù… Ù‡Ùˆ Ø£Ø³Ø§Ø³ Ø§Ù„Ø¨ÙŠØª Ø¹Ù†Ø¯ÙƒÙ…." },
                    calm_protect: { title:"Soft Hearts", icon:"ğŸ§¸", desc:"Ø§Ù„Ø­Ù†ÙŠØ© ØºØ§Ù„Ø¨Ø© Ø¹Ù„ÙŠÙƒÙ…." }
                }
            },
            jealousy: {
                questions: [
                    { t: "Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ø¬Øª Ù„Ø´Ø±ÙŠÙƒÙƒ Ø§Ù„Ø³Ø§Ø¹Ø© 12 Ø¨Ø§Ù„Ù„ÙŠÙ„.", 
                      opts: [{txt:"Ù…ÙŠÙ† Ø¯Ù‡ØŸ (Ø´Ùƒ)", type:"jealous"}, {txt:"ØªÙ„Ø§Ù‚ÙŠÙ‡ Ø´ØºÙ„ (Ø«Ù‚Ø©)", type:"trust"}] },
                    { t: "Ø¨Ø§Ø³ÙˆÙˆØ±Ø¯ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„..", 
                      opts: [{txt:"Ù…Ø¹ Ø¨Ø¹Ø¶ Ø¥Ø­Ù†Ø§ Ø§Ù„Ø§ØªÙ†ÙŠÙ†", type:"open"}, {txt:"ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙˆØ®ØµÙˆØµÙŠØªÙ‡", type:"private"}] },
                    { t: "Ù„Ùˆ Ø­Ø¯ ÙƒØªØ¨ ÙƒÙˆÙ…Ù†Øª Ø­Ù„Ùˆ Ù„Ø´Ø±ÙŠÙƒÙƒ..", 
                      opts: [{txt:"Ù…ÙŠÙ† Ø¯ÙŠ/Ø¯Ù‡ØŸ (Ù…Ø´ÙƒÙ„Ø©)", type:"fire"}, {txt:"Ø¹Ø§Ø¯ÙŠØŒ Ø´Ø±ÙŠÙƒÙŠ Ù…Ø­Ø¨ÙˆØ¨", type:"cool"}] },
                    { t: "Ø§Ù„Ù†Ø¨Ø´ ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠ..", 
                      opts: [{txt:"Ù„Ø§Ø²Ù… Ù†Ø¹Ø±Ù ÙƒÙ„ ØªÙØµÙŠÙ„Ø©", type:"dig"}, {txt:"Ø§Ù„Ù„ÙŠ ÙØ§Øª Ù…Ø§Øª", type:"moveon"}] }
                ],
                results: {
                    default: { title:"Secure Love", icon:"ğŸ”’", desc:"ÙÙŠÙ‡ Ø«Ù‚Ø© Ù…ØªØ¨Ø§Ø¯Ù„Ø© Ù…Ø±ÙŠØ­Ø©." },
                    jealous_fire: { title:"Burning Passion", icon:"ğŸ”¥", desc:"Ø§Ù„Ø­Ø¨ Ø¹Ù†Ø¯ÙƒÙ… Ù†Ø§Ø± ÙˆØºÙŠØ±Ø©." },
                    trust_cool: { title:"Cool Partners", icon:"â„ï¸", desc:"ÙˆØ§Ø«Ù‚ÙŠÙ† ÙÙŠ Ù†ÙØ³ÙƒÙ… ÙˆÙÙŠ Ø¨Ø¹Ø¶." }
                }
            }
        };

        const pacts = [
            "ÙˆØ¹Ø¯: Ù‚Ø±Ø§Ø¡Ø© Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ Ø³ÙˆÙŠØ§Ù‹ ÙƒÙ„ Ø®Ù…ÙŠØ³.",
            "ÙˆØ¹Ø¯: Ø¹Ø¯Ù… Ø§Ù„Ù†ÙˆÙ… ÙˆÙ†Ø­Ù† Ù…ØªØ®Ø§ØµÙ…Ø§Ù† Ø£Ø¨Ø¯Ø§Ù‹.",
            "ÙˆØ¹Ø¯: ÙƒÙ„Ù…Ø© 'Ø´ÙƒØ±Ø§Ù‹' Ùˆ 'ØªØ³Ù„Ù… Ø¥ÙŠØ¯Ùƒ' ØªÙƒÙˆÙ† Ø£Ø³Ø§Ø³ÙŠØ©.",
            "Ù…Ù‡Ù…Ø©: ÙƒØªØ§Ø¨Ø© Ø±Ø³Ø§Ù„Ø© ÙˆØ±Ù‚ÙŠØ© ÙÙŠÙ‡Ø§ 3 ØµÙØ§Øª ØªØ­Ø¨Ù‡Ø§ ÙÙŠ Ø§Ù„Ø¢Ø®Ø±.",
            "Ù…Ù‡Ù…Ø©: Ø§Ù„Ø§ØªÙØ§Ù‚ Ø¹Ù„Ù‰ 'ÙƒÙ„Ù…Ø© Ø³Ø±' Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­Ø¶Ù†.",
            "ÙˆØ¹Ø¯: Ø­ÙØ¸ Ø³Ø± Ø§Ù„Ø¨ÙŠØª ÙˆØ¹Ø¯Ù… Ø®Ø±ÙˆØ¬Ù‡ Ù„Ø£ÙŠ Ù…Ø®Ù„ÙˆÙ‚.",
            "Ù…Ù‡Ù…Ø©: Ø§Ù„ØªØ®Ø·ÙŠØ· Ù„Ø£ÙˆÙ„ Ø¹Ù…Ø±Ø© Ø³ÙˆÙŠØ§Ù‹ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡.",
            "ÙˆØ¹Ø¯: Ø§Ù„Ø±Ø§Ø¬Ù„ ÙŠÙˆØ¹Ø¯ Ø¥Ù†Ù‡ Ù…ÙŠØ®Ø±Ø¬Ø´ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø´ØºÙ„ ÙÙŠ Ø§Ù„Ø¨ÙŠØª.",
            "ÙˆØ¹Ø¯: Ø§Ù„Ø³Øª ØªÙˆØ¹Ø¯ Ø¥Ù†Ù‡Ø§ ØªÙƒÙˆÙ† Ù…ØµØ¯Ø± Ù‡Ø¯ÙˆØ¡ ÙˆÙ‚Øª Ø§Ù„Ø£Ø²Ù…Ø§Øª.",
            "Ù…Ù‡Ù…Ø©: Ù…Ø³Ùƒ Ø§Ù„Ø¥ÙŠØ¯ Ù„Ù…Ø¯Ø© Ø¯Ù‚ÙŠÙ‚Ø© ÙÙŠ ØµÙ…Øª ØªØ§Ù….",
            "ÙˆØ¹Ø¯: Ø®Ø±ÙˆØ¬Ø© Ø´Ù‡Ø±ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø£ÙˆÙ„Ø§Ø¯.",
            "Ù…Ù‡Ù…Ø©: ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙŠØ¹Ù…Ù„ Ù…Ø´Ø±ÙˆØ¨ Ù„Ù„ØªØ§Ù†ÙŠ Ø¯Ù„ÙˆÙ‚ØªÙŠ."
        ];

        // --- GAME LOGIC ---
        let currentEp = null;
        let qIndex = 0;
        let score = [];

        function showScreen(id) {
            $('.screen').removeClass('active');
            $(`#${id}`).addClass('active');
        }

        function startEpisode(key) {
            currentEp = episodes[key];
            qIndex = 0;
            score = [];
            showScreen('screen-game');
            renderNode();
        }

        function renderNode() {
            if(qIndex >= currentEp.questions.length) {
                showDiagnosis();
                return;
            }

            const q = currentEp.questions[qIndex];
            const txt = $('#narrative-box');
            const choices = $('#choices-box');

            txt.removeClass('animate__fadeIn');
            void txt[0].offsetWidth;
            txt.addClass('animate__fadeIn').text(q.t);

            choices.html('');
            q.opts.forEach(opt => {
                const btn = $(`<div class="choice-btn ar-font">${opt.txt}</div>`);
                btn.on('click', () => {
                    score.push(opt.type);
                    qIndex++;
                    showToast();
                    renderNode();
                });
                choices.append(btn);
            });
        }

        function showToast() {
            const t = $('#toast');
            t.addClass('show');
            setTimeout(() => t.removeClass('show'), 2000);
        }

        function showDiagnosis() {
            let resultKey = "default";
            const s = score.join("_");
            
            if(s.includes("separate") || s.includes("home")) resultKey = "home_separate";
            if(s.includes("out") || s.includes("fun")) resultKey = "out_fun";
            if(s.includes("logic") && s.includes("control")) resultKey = "logic_control";
            if(s.includes("yolo")) resultKey = "yolo";
            if(s.includes("stress")) resultKey = "stress_defend";
            if(s.includes("chill")) resultKey = "chill_open";
            if(s.includes("strict")) resultKey = "strict_firm";
            if(s.includes("calm")) resultKey = "calm_protect";
            if(s.includes("jealous") || s.includes("fire")) resultKey = "jealous_fire";
            if(s.includes("trust") && s.includes("cool")) resultKey = "trust_cool";

            const res = currentEp.results[resultKey] || currentEp.results["default"];

            $('#diag-icon').text(res.icon);
            $('#diag-title').text(res.title);
            $('#diag-desc').text(res.desc);

            showScreen('screen-diagnosis');
        }

        // --- ROULETTE ---
        function showWhoJudges() {
            $('#winner-name').text("???");
            $('#roulette-btn').show();
            showScreen('screen-who-judges');
        }

        function spinRoulette() {
            $('#roulette-btn').hide();
            const el = $('#winner-name');
            let count = 0;
            const interval = setInterval(() => {
                el.text(Math.random() > 0.5 ? "THE MAN" : "THE WOMAN");
                count++;
                if(count > 20) {
                    clearInterval(interval);
                    const winner = Math.random() > 0.5 ? "THE MAN" : "THE WOMAN";
                    el.text(winner);
                    el.addClass('animate__pulse');
                    setTimeout(pickJudgements, 2000);
                }
            }, 80);
        }

        function pickJudgements() {
            const list = $('#judgement-list');
            list.html('');
            const opts = pacts.sort(() => 0.5 - Math.random()).slice(0, 3);
            opts.forEach(p => {
                const item = $(`<div class="vow-card ar-font fw-bold text-center">${p}</div>`);
                item.on('click', () => sealPact(p));
                list.append(item);
            });
            showScreen('screen-pick');
        }

        function sealPact(txt) {
            $('#final-verdict-text').text(txt);
            showScreen('screen-final');
            for(let i=0; i<20; i++) setTimeout(spawnParticle, i*100);
        }

    </script>
</body>
</html>